{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://jstrack/./ts/functions.ts","webpack://jstrack/./ts/classes/point.ts","webpack://jstrack/./ts/classes/table.ts","webpack://jstrack/./ts/classes/track.ts","webpack://jstrack/./ts/classes/axes.ts","webpack://jstrack/./ts/classes/scale.ts","webpack://jstrack/./ts/classes/frame.ts","webpack://jstrack/./ts/classes/modal.ts","webpack://jstrack/./ts/globals.ts","webpack://jstrack/./ts/classes/project.ts","webpack://jstrack/./ts/classes/timeline.ts","webpack://jstrack/./ts/compatibility.ts","webpack://jstrack/./ts/scrubber.ts","webpack://jstrack/./ts/index.ts","webpack://jstrack/./ts/seeking.ts","webpack://jstrack/./ts/viewport.ts","webpack://jstrack/./ts/projectlisteners.ts","webpack://jstrack/./ts/saveDrive.ts","webpack://jstrack/./ts/modalevents.ts","webpack://jstrack/./ts/keycommands.ts","webpack://jstrack/./ts/buttons.ts","webpack://jstrack/./ts/load.ts","webpack://jstrack/./ts/handlefiles.ts","webpack://jstrack/./ts/backup.ts","webpack://jstrack/./ts/dom.ts"],"sourcesContent":["/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n *\n * Contact:\n *\n * Luca Demian\n * jstrack.luca@gmail.com\n *\n */\n\n//  Prototype Extensions \n\ndeclare global {\n  interface Array<T> {\n    last(): T | undefined;\n  }\n  interface Number {\n    roundTo(x: number): number;\n    roundSig(x: number): number;\n    toDegrees(): number;\n    toRadians(): number;\n    sigFigs(): number;\n  }\n  interface String {\n    roundTo(x: number): number;\n    sigFigs(): number;\n    utf8Length(): number;\n  }\n  interface Math {\n    cot(x: number): number;\n  }\n}\n\nif (!Array.prototype.last) {\n  Array.prototype.last = function <T>(this: T[]): T | undefined {\n    return this[this.length - 1];\n  };\n}\n\nif (!Number.prototype.roundTo) {\n  Number.prototype.roundTo = function (this: number, x: number): number {\n    return parseFloat(parseFloat(String(this)).toFixed(x));\n  };\n}\n\nif (!Number.prototype.roundSig) {\n  Number.prototype.roundSig = function (this: number, x: number): number {\n    return parseFloat(parseFloat(String(this)).toPrecision(x));\n  };\n}\n\nif (!String.prototype.roundTo) {\n  String.prototype.roundTo = function (this: string, x: number): number {\n    return parseFloat(parseFloat(this).toFixed(x));\n  };\n}\n\nif (!Number.prototype.toDegrees) {\n  Number.prototype.toDegrees = function (this: number): number {\n    return this * (180 / Math.PI);\n  };\n}\n\nif (!Number.prototype.toRadians) {\n  Number.prototype.toRadians = function (this: number): number {\n    return this * (Math.PI / 180);\n  };\n}\n\nif (!Number.prototype.sigFigs) {\n  Number.prototype.sigFigs = function (this: number): number {\n    const log10 = Math.log(10);\n    let n = Math.abs(Number(String(this).replace('.', '')));\n    if (n === 0) return 0;\n    while (n !== 0 && n % 10 === 0) n /= 10;\n    return Math.floor(Math.log(n) / log10) + 1;\n  };\n}\n\nif (!String.prototype.sigFigs) {\n  String.prototype.sigFigs = function (this: string): number {\n    const log10 = Math.log(10);\n    let n = Math.abs(Number(String(this).replace('.', '')));\n    if (n === 0) return 0;\n    while (n !== 0 && n % 10 === 0) n /= 10;\n    return Math.floor(Math.log(n) / log10) + 1;\n  };\n}\n\nif (!(Math as { cot?: (x: number) => number }).cot) {\n  (Math as { cot: (x: number) => number }).cot = function (number: number): number {\n    return 1 / Math.tan(number);\n  };\n}\n\nif (!String.prototype.utf8Length) {\n  String.prototype.utf8Length = function (this: string): number {\n    const m = encodeURIComponent(this).match(/%[89ABab]/g);\n    return this.length + (m ? m.length : 0);\n  };\n}\n\n//  Utility Functions \n\nexport function hideLoader(): void {\n  const el = document.getElementById('fullscreen-loader');\n  if (el) el.classList.remove('active');\n}\n\nexport function showLoader(): void {\n  const el = document.getElementById('fullscreen-loader');\n  if (el) el.classList.add('active');\n}\n\nexport function dataURLtoBlob(dataurl: string): Blob {\n  const arr = dataurl.split(',');\n  const mimeMatch = arr[0].match(/:(.*?);/);\n  const mime = mimeMatch ? mimeMatch[1] : 'application/octet-stream';\n  const bstr = atob(arr[1]);\n  let n = bstr.length;\n  const u8arr = new Uint8Array(n);\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new Blob([u8arr], { type: mime });\n}\n\nexport function isQuotaExceeded(e: { code?: number; name?: string; number?: number } | null): boolean {\n  let quotaExceeded = false;\n  if (e) {\n    if (e.code) {\n      switch (e.code) {\n        case 22:\n          quotaExceeded = true;\n          break;\n        case 1014:\n          if (e.name === 'NS_ERROR_DOM_QUOTA_REACHED') {\n            quotaExceeded = true;\n          }\n          break;\n      }\n    } else if (e.number === -2147024882) {\n      quotaExceeded = true;\n    }\n  }\n  return quotaExceeded;\n}\n\nexport function compareImages(img1: ImageData, img2: ImageData): boolean {\n  if (img1.data.length !== img2.data.length) return false;\n  for (let i = 0; i < img1.data.length; ++i) {\n    if (img1.data[i] !== img2.data[i]) return false;\n  }\n  return true;\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nimport '../functions';\nimport type { Track } from './track';\nimport type { Frame } from './frame';\nimport type { Axes } from './axes';\nimport type { Scale } from './scale';\n\nexport interface PointExportData {\n  t: number;\n  pixels: { x: number; y: number };\n  scaled: { x: number; y: number };\n}\n\nexport class Point {\n  track: Track;\n  frame: Frame;\n  hidden: boolean;\n  x: number;\n  y: number;\n  pointSize: number;\n  shape: createjs.Shape;\n  strokeWidth: createjs.GraphicsCommand;\n  strokeColor: createjs.GraphicsCommand;\n  pointRect: createjs.GraphicsCommand;\n  circle: createjs.Shape;\n  deleted: boolean;\n\n  constructor(track: Track, frame: Frame, x: number, y: number) {\n    this.track = track;\n    this.frame = frame;\n    this.hidden = false;\n    this.x = x;\n    this.y = y;\n    this.pointSize = 6;\n    this.shape = new createjs.Shape();\n    this.shape.cursor = 'pointer';\n    this.shape.regX = this.pointSize / 2;\n    this.shape.regY = this.pointSize / 2;\n    const unscaled = this.track.project.toUnscaled(x, y);\n    this.shape.x = unscaled.x;\n    this.shape.y = unscaled.y;\n    this.shape.rotation = 45;\n    this.shape.hitArea = new createjs.Shape(\n      new createjs.Graphics().beginFill('#000000').drawRect(-1, -1, 12, 12)\n    );\n\n    this.strokeWidth = this.shape.graphics.setStrokeStyle(2).command;\n    this.strokeColor = this.shape.graphics.beginStroke(this.track.color).command;\n    this.pointRect = this.shape.graphics\n      .drawRect(0, 0, this.pointSize, this.pointSize)\n      .command;\n\n    this.circle = new createjs.Shape();\n    this.circle.regX = (this.pointSize + 6) / 2;\n    this.circle.regY = (this.pointSize + 6) / 2;\n    this.circle.x = this.shape.x;\n    this.circle.y = this.shape.y;\n    this.circle.graphics.setStrokeStyle(2);\n    this.circle.graphics.beginStroke(this.track.color);\n    this.circle.graphics.drawEllipse(0, 0, this.pointSize + 6, this.pointSize + 6);\n\n    this.deleted = false;\n\n    if (this.track.state.mode !== 'add' && this.track.state.mode !== 'hidden') {\n      this.track.stage.addChild(this.shape);\n    }\n\n    const tempShape = this;\n    this.track.state.modeChange(function (this: Track, mode: string) {\n      if (mode === 'add' || mode === 'hidden') {\n        tempShape.track.stage.removeChild(tempShape.shape);\n        tempShape.track.stage.removeChild(tempShape.circle);\n      } else {\n        if (!tempShape.deleted && !tempShape.hidden) {\n          tempShape.track.stage.addChild(tempShape.shape);\n        }\n      }\n    });\n    let moving = false;\n    this.shape.on('pressmove', function (e: createjs.MouseEvent) {\n      if (tempShape.track.project.state.mode !== 'seek') {\n        const coords = tempShape.track.project.toScaled(e.stageX, e.stageY);\n        moving = true;\n        tempShape.move(coords.x, coords.y, true);\n        tempShape.select();\n      }\n    });\n    this.shape.on('pressup', function (e: createjs.MouseEvent) {\n      if (tempShape.track.project.state.mode !== 'seek' && moving) {\n        moving = false;\n        const coords = tempShape.track.project.toScaled(e.stageX, e.stageY);\n\n        const goTo = { x: tempShape.x, y: tempShape.y };\n        tempShape.track.project.change({\n          undo: function () {\n            tempShape.move(goTo.x, goTo.y);\n          },\n          redo: function () {\n            tempShape.move(coords.x, coords.y);\n          },\n        });\n\n        tempShape.move(coords.x, coords.y);\n        tempShape.track.project.update();\n      }\n    });\n    this.shape.on('dblclick', function () {\n      tempShape.remove();\n\n      tempShape.track.project.change({\n        undo: function () {\n          const tempPoint = tempShape.track.deletedPoints[tempShape.frame.number];\n          if (tempPoint) {\n            tempPoint.deleted = false;\n            tempShape.track.points[tempPoint.frame.number] = tempPoint;\n            tempShape.track.stage.addChild(tempPoint.shape);\n            tempShape.track.project.update();\n          }\n        },\n        redo: function () {\n          tempShape.remove();\n        },\n      });\n    });\n    this.shape.on('click', function () {\n      tempShape.track.unselectAll();\n      tempShape.select();\n\n      if (tempShape.track.project.state.mode === 'seek') {\n        tempShape.track.project.timeline.seek(tempShape.frame.number);\n        tempShape.track.project.switchTrack(tempShape.track.uid);\n        tempShape.track.project.changed();\n      }\n    });\n    this.track.project.state.modeChange(function (mode: string) {\n      if (mode === 'seek') {\n        tempShape.shape.cursor = 'crosshair';\n      } else {\n        tempShape.shape.cursor = 'pointer';\n      }\n    });\n  }\n\n  hide(): this {\n    this.track.stage.removeChild(this.shape);\n    this.track.stage.removeChild(this.circle);\n    this.hidden = true;\n    return this;\n  }\n\n  show(): this {\n    if (!this.deleted) {\n      this.track.stage.addChild(this.shape);\n      this.hidden = false;\n    }\n    return this;\n  }\n\n  color(color: string): void {\n    this.strokeColor.style = color;\n  }\n\n  export(\n    axes: Axes | null = this.track.project.axes,\n    scale: Scale | null = this.track.project.scale\n  ): PointExportData | undefined {\n    const point = this;\n\n    if (\n      point.frame.number >= point.track.timeline.startFrame &&\n      point.frame.number <= point.track.timeline.endFrame\n    ) {\n      if (!axes) return undefined;\n      const location = axes.convert(point.x, point.y);\n\n      const data: PointExportData = {\n        t: (\n          point.track.project.videoSpeed *\n          (point.frame.time -\n            point.track.timeline.getFrameStart(point.track.timeline.startFrame))\n        ).roundSig(6),\n        pixels: { x: 0, y: 0 },\n        scaled: { x: 0, y: 0 },\n      };\n\n      data.pixels.x = location.x.roundTo(5);\n      data.pixels.y = location.y.roundTo(5);\n\n      if (scale === null || scale === undefined) {\n        data.scaled.x = location.x.roundTo(5);\n        data.scaled.y = location.y.roundTo(5);\n      } else {\n        data.scaled.x = scale.convert(location.x).number.roundTo(5);\n        data.scaled.y = scale.convert(location.y).number.roundTo(5);\n      }\n\n      return data;\n    }\n    return undefined;\n  }\n\n  emphasize(multiple = false): this {\n    if (!multiple) this.track.unemphasizeAll();\n    if (!this.track.hidden && !this.hidden && this.track.state.mode !== 'add')\n      this.track.stage.addChild(this.circle);\n    this.circle.x = this.shape.x;\n    this.circle.y = this.shape.y;\n    this.track.emphasizedPoint = this;\n    return this;\n  }\n\n  unemphasize(): void {\n    this.track.stage.removeChild(this.circle);\n    this.track.emphasizedPoint = null;\n    this.track.stage.update();\n  }\n\n  select(multiple = false): this {\n    if (!multiple) this.track.unselectAll();\n    this.shape.rotation = 0;\n    this.strokeWidth.width = 2;\n    this.pointRect.w = this.pointSize + 2;\n    this.pointRect.h = this.pointSize + 2;\n    this.shape.regX = (this.pointSize + 2) / 2;\n    this.shape.regY = (this.pointSize + 2) / 2;\n\n    this.track.selectedPoint = this;\n    return this;\n  }\n\n  unselect(): this {\n    this.shape.rotation = 45;\n    this.strokeWidth.width = 2;\n    this.pointRect.w = this.pointSize;\n    this.pointRect.h = this.pointSize;\n    this.shape.regX = this.pointSize / 2;\n    this.shape.regY = this.pointSize / 2;\n    this.track.selectedPoint = null;\n    return this;\n  }\n\n  move(x: number, y: number, internal = false): this {\n    const unscaled = this.track.project.toUnscaled(x, y);\n    this.shape.x = unscaled.x;\n    this.shape.y = unscaled.y;\n    this.circle.x = unscaled.x;\n    this.circle.y = unscaled.y;\n    if (!internal) {\n      this.x = x;\n      this.y = y;\n    }\n    return this;\n  }\n\n  remove(): void {\n    this.track.stage.removeChild(this.shape);\n    this.track.stage.removeChild(this.circle);\n    this.unselect().unemphasize();\n    this.deleted = true;\n    this.track.deletedPoints[this.frame.number] = this;\n    delete this.track.points[this.frame.number];\n    this.track.project.update();\n  }\n\n  unRemove(): void {\n    if (!this.track.hidden && !this.hidden) {\n      this.track.stage.addChild(this.shape);\n    }\n    this.deleted = false;\n    this.track.points[this.frame.number] = this;\n    delete this.track.deletedPoints[this.frame.number];\n    this.track.project.update();\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nimport type { Track } from './track';\n\ninterface ColumnSetting {\n  title: string;\n  type: string;\n}\n\nexport interface TableColumns {\n  [key: string]: string;\n}\n\nexport type TableRowData = Record<string, number | string | null>;\n\nexport class Table {\n  track: Track;\n  columns: TableColumns;\n  data: TableRowData[];\n  tableData: Array<Array<number | string | null>>;\n  settings: { columns: ColumnSetting[] };\n\n  constructor(track: Track, columns: TableColumns) {\n    this.track = track;\n    this.columns = columns;\n    this.data = [];\n    this.tableData = [];\n    const columnArray: ColumnSetting[] = [];\n    for (const title in columns) {\n      columnArray.push({\n        title: title + '(' + columns[title] + ')',\n        type: 'text',\n      });\n    }\n    this.settings = {\n      columns: columnArray,\n    };\n  }\n\n  makeActive(): void {\n    const settings = this.settings;\n    const data = this.tableData;\n    this.track.project.handsOnTable.updateSettings(settings);\n    if (data.length > 0) this.track.project.handsOnTable.loadData(data);\n    else this.track.project.handsOnTable.loadData([null]);\n  }\n\n  newCols(columns: TableColumns): void {\n    this.columns = columns;\n    const columnArray: ColumnSetting[] = [];\n    for (const title in columns) {\n      columnArray.push({\n        title: title + '(' + columns[title] + ')',\n        type: 'text',\n      });\n    }\n    this.settings.columns = columnArray;\n    this.track.project.handsOnTable.updateSettings(this.settings);\n  }\n\n  newData(data: TableRowData[], update = true, replace = true): void {\n    if (replace) {\n      this.tableData = [];\n      this.data = [];\n    }\n    for (let i = 0; i < data.length; i++) {\n      const tempRow: Array<number | string | null> = [];\n      for (const column in this.columns) {\n        if (data[i][column] !== undefined) {\n          tempRow.push(data[i][column]);\n        } else {\n          tempRow.push(null);\n        }\n      }\n      this.tableData.push(tempRow);\n      this.data.push(data[i]);\n    }\n    this.sort();\n\n    if (replace) this.track.project.handsOnTable.updateSettings({ data: [] });\n    if (update) this.track.project.handsOnTable.loadData(this.tableData);\n  }\n\n  addColumn(newColumns: TableColumns): void {\n    for (const title in newColumns) {\n      if (this.columns[title] === undefined) {\n        this.columns[title] = newColumns[title];\n\n        const tempData: Array<Array<number | string | null>> = [];\n        for (let i = 0; i < this.data.length; i++) {\n          const tempRow: Array<number | string | null> = [];\n          for (const column in this.columns) {\n            if (this.data[i][column] !== undefined) {\n              tempRow.push(this.data[i][column]);\n            } else {\n              tempRow.push(null);\n            }\n          }\n          tempData.push(tempRow);\n        }\n        this.tableData = tempData;\n        this.sort();\n\n        this.settings.columns.push({\n          title: title + '(' + newColumns[title] + ')',\n          type: 'text',\n        });\n        this.makeActive();\n      }\n    }\n  }\n\n  addRow(row: TableRowData, update = false): void {\n    const tempRow: Array<number | string | null> = [];\n    for (const column in this.columns) {\n      if (row[column] !== undefined) {\n        tempRow.push(row[column]);\n      } else {\n        tempRow.push(null);\n      }\n    }\n    this.data.push(row);\n    this.tableData.push(tempRow);\n    this.sort();\n\n    if (update) this.track.project.handsOnTable.loadData(this.tableData);\n  }\n\n  sort(index: number | string = 0): void {\n    if (typeof index === 'number') {\n      this.tableData.sort(function (a, b) {\n        const aVal = a[index];\n        const bVal = b[index];\n        if (aVal === null || bVal === null) return 0;\n        if (aVal < bVal) return -1;\n        else if (aVal > bVal) return 1;\n        else return 0;\n      });\n    } else {\n      this.data.sort(function (a, b) {\n        const aVal = a[index];\n        const bVal = b[index];\n        if (aVal === null || bVal === null || aVal === undefined || bVal === undefined) return 0;\n        if (aVal < bVal) return -1;\n        else if (aVal > bVal) return 1;\n        else return 0;\n      });\n    }\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nimport '../functions';\nimport type { Project } from './project';\nimport type { Timeline } from './timeline';\nimport type { Frame } from './frame';\nimport type { Axes } from './axes';\nimport type { Scale } from './scale';\nimport { Point, type PointExportData } from './point';\nimport { Table, type TableRowData } from './table';\n\ntype TrackModeCallback = (this: Track, mode: string, lastMode: string) => void;\ntype TrackSelectionCallback = (selected: boolean) => void;\n\ninterface TrackState {\n  _mode: string;\n  _lastMode: string;\n  _selected: boolean;\n  modeCallbacks: TrackModeCallback[];\n  selectionCallbacks: TrackSelectionCallback[];\n  mode: string;\n  selected: boolean;\n  triggerChange(): void;\n  resetMode(): void;\n  modeChange(val: TrackModeCallback): void;\n  selectionChange(val: TrackSelectionCallback): void;\n}\n\ninterface TrackListElement {\n  container: HTMLLIElement;\n  swath: HTMLDivElement;\n  name: HTMLDivElement;\n  visibility: HTMLDivElement;\n  delete: HTMLDivElement;\n}\n\nexport interface TrackExportData {\n  name: string;\n  points: {\n    scaled: TableRowData[];\n    pixels: TableRowData[];\n  };\n  table: {\n    scaled: Array<Array<string | number>>;\n    pixels: Array<Array<string | number>>;\n  };\n}\n\nexport class Track {\n  name: string;\n  color: string;\n  project: Project;\n  hidden: boolean;\n  selectedPoints: Record<string, Point>;\n  unit: string;\n  timeline: Timeline;\n  stage: createjs.Stage;\n  points: Record<number, Point>;\n  deletedPoints: Record<number, Point>;\n  selectedPoint: Point | null;\n  emphasizedPoint: Point | null;\n  table: Table;\n  uid: string;\n  listElement: TrackListElement;\n  state: TrackState;\n  scale!: Scale;\n\n  constructor(\n    project: Project,\n    timeline: Timeline,\n    name: string,\n    color: string,\n    stage: createjs.Stage,\n    uid: string | false = false\n  ) {\n    this.name = name;\n    this.color = color;\n    this.project = project;\n    this.hidden = false;\n    this.selectedPoints = {};\n\n    if (this.project.scale === null || this.project.scale === undefined) {\n      this.unit = 'px';\n    } else {\n      this.unit = this.project.scale.unit().toString();\n    }\n    this.timeline = timeline;\n    this.stage = stage;\n    this.points = {};\n    this.deletedPoints = {};\n    this.selectedPoint = null;\n    this.emphasizedPoint = null;\n    this.table = new Table(this, { t: 's', x: this.unit, y: this.unit });\n    if (uid === false)\n      this.uid = (Math.round(Math.random() * 100000000) + 1).toString();\n    else this.uid = uid.toString();\n    this.listElement = {\n      container: document.createElement('li'),\n      swath: document.createElement('div'),\n      name: document.createElement('div'),\n      visibility: document.createElement('div'),\n      delete: document.createElement('div'),\n    };\n    this.listElement.container.setAttribute('data-uid', this.uid);\n    this.listElement.container.title = 'Double Click to Edit';\n    this.listElement.swath.classList.add('swath');\n    this.listElement.swath.style.background = this.color;\n    this.listElement.name.classList.add('name');\n    this.listElement.name.innerText = this.name;\n    this.listElement.visibility.classList.add('visibility');\n    this.listElement.visibility.title = 'Hide Track';\n    this.listElement.delete.classList.add('delete');\n    this.listElement.delete.title = 'Delete Track';\n\n    const trackListUl = document.getElementById('track-list')?.querySelector('ul');\n    if (trackListUl) trackListUl.appendChild(this.listElement.container);\n    this.listElement.container.appendChild(this.listElement.swath);\n    this.listElement.container.appendChild(this.listElement.name);\n    this.listElement.container.appendChild(this.listElement.delete);\n    this.listElement.container.appendChild(this.listElement.visibility);\n\n    const track = this;\n    this.state = {\n      _mode: 'default',\n      _lastMode: '',\n      _selected: true,\n      modeCallbacks: [],\n      selectionCallbacks: [],\n      set mode(val: string) {\n        if (this._mode !== val) {\n          this._lastMode = this._mode;\n          this._mode = val;\n        }\n        this.triggerChange();\n      },\n      get mode(): string {\n        return this._mode;\n      },\n      triggerChange() {\n        for (let i = 0; i < this.modeCallbacks.length; i++) {\n          this.modeCallbacks[i].call(track, this._mode, this._lastMode);\n        }\n      },\n      resetMode() {\n        const tempLastMode = this._lastMode;\n        this._lastMode = this._mode;\n        this._mode = tempLastMode;\n        this.triggerChange();\n      },\n      modeChange(val: TrackModeCallback) {\n        this.modeCallbacks.push(val);\n      },\n      set selected(val: boolean) {\n        this._selected = val;\n        for (let i = 0; i < this.selectionCallbacks.length; i++) {\n          this.selectionCallbacks[i](this._selected);\n        }\n      },\n      get selected(): boolean {\n        return this._selected;\n      },\n      selectionChange(val: TrackSelectionCallback) {\n        this.selectionCallbacks.push(val);\n      },\n    };\n\n    const tempTrack = this;\n    this.stage.addEventListener('click', function (e: createjs.MouseEvent) {\n      const point = tempTrack.selectedPoint;\n      if (point !== null && point !== undefined) {\n        const mouseCoords = point.shape.globalToLocal(e.stageX, e.stageY);\n        if (\n          mouseCoords.x < -1 ||\n          mouseCoords.x > 12 ||\n          mouseCoords.y < -1 ||\n          mouseCoords.y > 12\n        ) {\n          point.unselect();\n        }\n      }\n    });\n    this.listElement.container.addEventListener('click', function () {\n      let lastUid = '';\n      if (tempTrack.project.track !== null && tempTrack.project.track !== undefined) {\n        lastUid = tempTrack.project.track.uid;\n      }\n      tempTrack.project.change({\n        undo: function () {\n          tempTrack.project.switchTrack(lastUid);\n        },\n        redo: function () {\n          tempTrack.project.switchTrack(tempTrack.uid);\n        },\n      });\n\n      tempTrack.project.switchTrack(tempTrack.uid);\n    });\n    this.listElement.container.addEventListener('dblclick', function () {\n      // editTrack is a global modal - accessed via the app module\n      const editTrackModal = (window as unknown as Record<string, { push: (data: Record<string, string>) => { show: () => void } }>)['editTrack'];\n      if (editTrackModal) {\n        editTrackModal.push({\n          name: tempTrack.name,\n          color: tempTrack.color,\n          uid: tempTrack.uid,\n        }).show();\n      }\n    });\n\n    this.listElement.delete.addEventListener('click', function (e) {\n      e.stopPropagation();\n      tempTrack.project.change({\n        undo: function () {\n          tempTrack.project.undeleteTrack(tempTrack.uid);\n        },\n        redo: function () {\n          tempTrack.project.deleteTrack(tempTrack.uid);\n        },\n      });\n\n      tempTrack.project.deleteTrack(tempTrack.uid);\n    });\n    this.listElement.visibility.addEventListener(\n      'click',\n      function (this: HTMLDivElement, e) {\n        e.stopPropagation();\n        if (this.classList.contains('hidden')) {\n          tempTrack.project.change({\n            undo: function () {\n              tempTrack.hide();\n            },\n            redo: function () {\n              tempTrack.show();\n            },\n          });\n          tempTrack.show();\n        } else {\n          tempTrack.project.change({\n            undo: function () {\n              tempTrack.show();\n            },\n            redo: function () {\n              tempTrack.hide();\n            },\n          });\n          tempTrack.hide();\n        }\n      },\n      false\n    );\n  }\n\n  hide(): void {\n    this.state.mode = 'hidden';\n    this.hidden = true;\n    this.listElement.visibility.classList.add('hidden');\n    this.listElement.visibility.title = 'Make Visible';\n  }\n\n  show(): void {\n    this.state.resetMode();\n    this.hidden = false;\n    this.listElement.visibility.classList.remove('hidden');\n    this.listElement.visibility.title = 'Hide Track';\n  }\n\n  update(data: Record<string, string>): void {\n    for (const key in data) {\n      switch (key) {\n        case 'name':\n          this.name = data[key];\n          this.listElement.name.innerText = this.name;\n          this.project.changed();\n          break;\n        case 'color':\n          this.color = data[key];\n          this.listElement.swath.style.background = this.color;\n          for (const pointKey in this.points) {\n            this.points[pointKey].color(this.color);\n          }\n          this.project.changed();\n          break;\n      }\n    }\n  }\n\n  export(\n    axes: Axes | null = this.project.axes,\n    scale: Scale | null = this.project.scale\n  ): TrackExportData {\n    const track = this;\n    const data: TrackExportData = {\n      name: this.name,\n      points: { scaled: [], pixels: [] },\n      table: { scaled: [], pixels: [] },\n    };\n\n    data.table.scaled.push([\n      't (s)',\n      'x (' + track.unit + ')',\n      'y (' + track.unit + ')',\n    ]);\n    data.table.pixels.push([\n      't (s)',\n      'x (' + track.unit + ')',\n      'y (' + track.unit + ')',\n    ]);\n\n    for (const key in track.points) {\n      if (track.points.hasOwnProperty(key)) {\n        const point = track.points[key];\n        const pointData: PointExportData | undefined = point.export(axes, scale);\n        if (pointData !== undefined) {\n          const pushData = {\n            pixels: {\n              t: pointData.t,\n              x: pointData.pixels.x,\n              y: pointData.pixels.y,\n            },\n            scaled: {\n              t: pointData.t,\n              x: pointData.scaled.x,\n              y: pointData.scaled.y,\n            },\n          };\n\n          data.points.pixels.push(pushData.pixels);\n          data.table.pixels.push([pushData.pixels.t, pushData.pixels.x, pushData.pixels.y]);\n\n          data.points.scaled.push(pushData.scaled);\n          data.table.scaled.push([pushData.scaled.t, pushData.scaled.x, pushData.scaled.y]);\n        }\n      }\n    }\n    return data;\n  }\n\n  addPoint(frame: Frame, x: number, y: number, userAction = true): Point {\n    if (this.points[frame.number] !== undefined) {\n      const track = this;\n      const point = this.points[frame.number];\n      const toGo = { x: point.x, y: point.y };\n      this.project.change({\n        undo: function () {\n          point.move(toGo.x, toGo.y);\n          track.project.timeline.seek(frame.number);\n          track.project.update();\n        },\n        redo: function () {\n          point.move(x, y);\n          track.project.timeline.seek(frame.number);\n          track.project.update();\n        },\n      });\n\n      point.move(x, y).select();\n      this.project.trigger('newpoint');\n      this.project.update();\n      this.project.updateVisiblePoints();\n      return this.points[frame.number];\n    } else {\n      const newPoint = new Point(this, frame, x, y);\n      this.points[frame.number] = newPoint;\n      frame.points.push(newPoint);\n      this.project.timeline.activeFrames.push(frame);\n\n      const track = this;\n      this.project.change({\n        undo: function () {\n          newPoint.remove();\n          track.project.timeline.seek(newPoint.frame.number);\n          track.project.update();\n        },\n        redo: function () {\n          newPoint.unRemove();\n          track.project.timeline.seek(newPoint.frame.number);\n          track.project.update();\n        },\n      });\n\n      const pointData = newPoint.export();\n      if (pointData !== undefined)\n        this.table.addRow(\n          { t: pointData.t, x: pointData.scaled.x, y: pointData.scaled.y },\n          true\n        );\n\n      this.project.trigger('newpoint');\n      this.project.updateVisiblePoints();\n      return newPoint;\n    }\n  }\n\n  unselectAll(): void {\n    if (this.selectedPoint !== null && this.selectedPoint !== undefined) {\n      this.selectedPoint.unselect();\n    }\n    this.selectedPoint = null;\n  }\n\n  unemphasizeAll(): void {\n    if (this.emphasizedPoint !== null && this.emphasizedPoint !== undefined) {\n      this.emphasizedPoint.unemphasize();\n    }\n    this.emphasizedPoint = null;\n  }\n\n  select(): void {\n    const trackListUl = document.getElementById('track-list')?.querySelector('ul');\n    if (trackListUl) {\n      trackListUl.querySelectorAll('li').forEach(function (el) {\n        el.classList.remove('selected');\n      });\n    }\n    this.listElement.container.classList.add('selected');\n  }\n\n  unselect(): void {\n    this.listElement.container.classList.remove('selected');\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nimport '../functions';\nimport type { Project } from './project';\n\nexport interface Coordinate {\n  x: number;\n  y: number;\n}\n\nexport class Axes {\n  stage: createjs.Stage;\n  project: Project;\n  x: number;\n  y: number;\n  theta: number;\n  color: string;\n  styles: { color: createjs.GraphicsCommand[] };\n  size: number;\n  shape: createjs.Shape;\n  hitShape: createjs.Shape;\n\n  constructor(stage: createjs.Stage, x: number, y: number, color: string, project: Project) {\n    this.stage = stage;\n    this.project = project;\n    this.x = x;\n    this.y = y;\n    this.theta = 0;\n    this.color = color;\n    this.styles = {\n      color: [],\n    };\n    this.size =\n      Math.sqrt(Math.pow(window.innerWidth, 2) + Math.pow(window.innerHeight, 2)) * 4;\n    this.shape = new createjs.Shape();\n    const unscaled = this.project.toUnscaled(this.x, this.y);\n    this.shape.x = unscaled.x;\n    this.shape.y = unscaled.y;\n    this.shape.rotation = this.theta;\n    this.shape.cursor = 'pointer';\n    this.stage.addChild(this.shape);\n    this.styles.color.push(this.shape.graphics.beginFill(this.color).command);\n    this.shape.graphics.drawRect(19, -6, 2, 12);\n    this.shape.graphics.drawRect(-this.size / 2, -1, this.size, 2);\n    this.shape.graphics.drawRect(-1, -this.size / 2, 2, this.size);\n\n    this.hitShape = new createjs.Shape();\n\n    this.styles.color.push(this.hitShape.graphics.beginFill(this.color).command);\n    this.hitShape.graphics.drawRect(-this.size / 2, -3, this.size, 6);\n    this.hitShape.graphics.drawRect(-3, -this.size / 2, 6, this.size);\n    this.shape.hitArea = this.hitShape;\n\n    const parent = this;\n    let moving = false;\n    let rotating = false;\n    this.shape.addEventListener('mousedown', function (e: createjs.MouseEvent) {\n      const coords = e.target.stage.globalToLocal(e.stageX, e.stageY);\n      moving = false;\n      rotating = false;\n      const mouseCoords = parent.convert(parent.project.toScaled(coords));\n      if (\n        mouseCoords.x < 20 &&\n        mouseCoords.x > -20 &&\n        mouseCoords.y < 20 &&\n        mouseCoords.y > -20\n      ) {\n        moving = true;\n        parent.shape.cursor = 'grabbing';\n        parent.stage.update();\n        parent.stage._testMouseOver(true);\n      } else if (mouseCoords.x > 20) {\n        rotating = true;\n        moving = false;\n      }\n    });\n    this.shape.addEventListener('tick', function (e: createjs.MouseEvent) {\n      const coords = e.target.stage.globalToLocal(stage.mouseX, stage.mouseY);\n      const mouseCoords = parent.convert(\n        parent.project.toScaled(coords.x, coords.y)\n      );\n      if (\n        mouseCoords.x < 20 &&\n        mouseCoords.x > -20 &&\n        mouseCoords.y < 20 &&\n        mouseCoords.y > -20\n      ) {\n        if (moving) {\n          parent.shape.cursor = 'grabbing';\n        } else {\n          parent.shape.cursor = 'grab';\n          parent.stage._testMouseOver(true);\n        }\n      } else if (mouseCoords.x > 20) {\n        parent.cursor();\n      } else {\n        parent.shape.cursor = 'default';\n      }\n    });\n    this.shape.addEventListener('pressmove', function (e: createjs.MouseEvent) {\n      const coords = parent.project.toScaled(e.stageX, e.stageY);\n      const coordsUnscaled = parent.project.toUnscaled(coords);\n\n      if (moving) {\n        parent.shape.cursor = 'grabbing';\n        parent.shape.x = coordsUnscaled.x - 1;\n        parent.shape.y = coordsUnscaled.y - 1;\n      } else if (rotating) {\n        let sign = 1;\n        let reference = Math.PI;\n\n        if (coords.y > parent.y && coords.x > parent.x) {\n          sign = 1;\n          reference = Math.PI * 2;\n        } else if (coords.y > parent.y && coords.x < parent.x) {\n          sign = 1;\n          reference = Math.PI;\n        } else if (coords.y < parent.y && coords.x < parent.x) {\n          sign = 1;\n          reference = Math.PI;\n        } else if (coords.y < parent.y && coords.x > parent.x) {\n          sign = 1;\n          reference = 0;\n        }\n\n        let theta =\n          sign *\n          (-sign * Math.atan((parent.y - coords.y) / (parent.x - coords.x)) + reference);\n        if (theta === Math.PI && coords.x > parent.x) {\n          theta = 0;\n        }\n\n        parent.cursor(theta.toDegrees());\n\n        parent.shape.rotation = -theta.toDegrees();\n      }\n    });\n    this.shape.addEventListener('pressup', function () {\n      if (moving) {\n        const lastCoords = {\n          x: parent.x,\n          y: parent.y,\n        };\n\n        const lastCoordsUnscaled = parent.project.toUnscaled(lastCoords);\n\n        const newCoordsUnscaled = {\n          x: parent.shape.x,\n          y: parent.shape.y,\n        };\n        const coords = parent.project.toScaled(parent.shape.x, parent.shape.y);\n        parent.x = coords.x;\n        parent.y = coords.y;\n\n        parent.project.change({\n          undo: function () {\n            parent.x = lastCoords.x;\n            parent.y = lastCoords.y;\n            parent.shape.x = lastCoordsUnscaled.x - 1;\n            parent.shape.y = lastCoordsUnscaled.y - 1;\n            parent.project.update();\n          },\n          redo: function () {\n            parent.x = coords.x;\n            parent.y = coords.y;\n            parent.shape.x = newCoordsUnscaled.x - 1;\n            parent.shape.y = newCoordsUnscaled.y - 1;\n            parent.project.update();\n          },\n        });\n      } else if (rotating) {\n        const lastRotation = parent.theta;\n        const newRotation = (parent.theta = -parent.shape.rotation.toRadians());\n        parent.project.change({\n          undo: function () {\n            parent.theta = lastRotation;\n            parent.shape.rotation = -lastRotation.toDegrees();\n            parent.project.update();\n          },\n          redo: function () {\n            parent.theta = newRotation;\n            parent.shape.rotation = -newRotation.toDegrees();\n            parent.project.update();\n          },\n        });\n      }\n\n      parent.project.update();\n      moving = false;\n      rotating = false;\n    });\n  }\n\n  hide(): void {\n    this.stage.removeChild(this.shape);\n  }\n\n  show(): void {\n    this.stage.addChild(this.shape);\n  }\n\n  rotate(radians: number): void {\n    this.theta = radians;\n    this.shape.rotation = -this.theta.toDegrees();\n  }\n\n  updateColor(color: string): void {\n    this.color = color;\n    for (let i = 0; i < this.styles.color.length; i++) {\n      this.styles.color[i].style = this.color;\n    }\n    this.project.changed();\n  }\n\n  cursor(cursorDegree: number = this.theta.toDegrees()): void {\n    if (\n      (cursorDegree >= 0 && cursorDegree <= 20) ||\n      (cursorDegree > 340 && cursorDegree <= 360)\n    ) {\n      this.shape.cursor = 'ns-resize';\n    } else if (cursorDegree > 20 && cursorDegree <= 60) {\n      this.shape.cursor = 'nw-resize';\n    } else if (cursorDegree > 60 && cursorDegree <= 120) {\n      this.shape.cursor = 'ew-resize';\n    } else if (cursorDegree > 120 && cursorDegree <= 160) {\n      this.shape.cursor = 'ne-resize';\n    } else if (cursorDegree > 160 && cursorDegree <= 200) {\n      this.shape.cursor = 'ns-resize';\n    } else if (cursorDegree > 200 && cursorDegree <= 250) {\n      this.shape.cursor = 'se-resize';\n    } else if (cursorDegree > 250 && cursorDegree <= 290) {\n      this.shape.cursor = 'ew-resize';\n    } else if (cursorDegree > 290 && cursorDegree <= 340) {\n      this.shape.cursor = 'ne-resize';\n    }\n  }\n\n  convert(x: number | Coordinate, y: number | null = null): Coordinate {\n    if (typeof x === 'object' && y === null) {\n      y = x.y;\n      x = x.x;\n    }\n    if (typeof x !== 'number' || typeof y !== 'number') {\n      return { x: 0, y: 0 };\n    }\n\n    const coords = { x: x, y: -y };\n    const origin = { x: this.x, y: -this.y };\n\n    const tan = Math.tan(this.theta);\n    const cot = Math.cot(this.theta);\n\n    const interceptX = { x: 0, y: 0 };\n    interceptX.x =\n      (-origin.y + coords.y + tan * origin.x + cot * coords.x) / (cot + tan);\n    interceptX.y = tan * interceptX.x + (origin.y - tan * origin.x);\n\n    const interceptY = { x: 0, y: 0 };\n    interceptY.x =\n      (-coords.y + origin.y + tan * coords.x + cot * origin.x) / (cot + tan);\n    interceptY.y = -cot * interceptY.x + (origin.y + cot * origin.x);\n\n    let signX = Math.sign(interceptX.x - origin.x);\n    if (this.theta > 0.5 * Math.PI && this.theta < 1.5 * Math.PI) {\n      signX *= -1;\n    }\n\n    let location = {\n      x:\n        signX *\n        Math.sqrt(\n          Math.pow(interceptX.y - origin.y, 2) + Math.pow(interceptX.x - origin.x, 2)\n        ),\n      y:\n        Math.sign(interceptY.y - origin.y) *\n        Math.sqrt(\n          Math.pow(interceptX.y - coords.y, 2) + Math.pow(interceptX.x - coords.x, 2)\n        ),\n    };\n\n    switch (this.theta) {\n      case 0:\n        location = { x: coords.x - origin.x, y: coords.y - origin.y };\n        break;\n      case 0.5 * Math.PI:\n        location = { x: coords.y - origin.y, y: origin.x - coords.x };\n        break;\n      case Math.PI:\n        location = { x: origin.x - coords.x, y: origin.y - coords.y };\n        break;\n      case 1.5 * Math.PI:\n        location = { x: origin.y - coords.y, y: coords.x - origin.x };\n        break;\n      case 2 * Math.PI:\n        location = { x: coords.x - origin.x, y: coords.y - origin.y };\n        break;\n    }\n\n    return location;\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nimport '../functions';\nimport type { Project } from './project';\nimport type { Coordinate } from './axes';\n\ninterface ScaleProcessedValue {\n  textValue: string;\n  size: MathJsUnit;\n}\n\nexport class Scale {\n  stage: createjs.Stage;\n  project: Project;\n  color: string;\n  nodeSize: number;\n  positions: [Coordinate, Coordinate];\n  textValue: string;\n  size: MathJsUnit;\n  hitArea: createjs.Shape;\n  nodes: [createjs.Shape, createjs.Shape];\n  length: number;\n  line: createjs.Shape;\n  lineStart: createjs.GraphicsCommand;\n  lineEnd: createjs.GraphicsCommand;\n  textSizingElement: HTMLSpanElement;\n  letterWidth: number;\n  textElement: HTMLInputElement;\n  text: createjs.DOMElement;\n  textHitShape: createjs.Shape;\n  textHit: createjs.GraphicsCommand;\n  uid: string;\n  styleCommands: { colors: createjs.GraphicsCommand[] };\n\n  constructor(\n    stage: createjs.Stage,\n    size: string | null,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    color: string,\n    project: Project\n  ) {\n    this.stage = stage;\n    this.project = project;\n    this.color = color;\n    this.nodeSize = 8;\n    this.uid = (Math.round(Math.random() * 100000000) + 1).toString();\n    this.positions = [\n      { x: x1, y: y1 },\n      { x: x2, y: y2 },\n    ];\n    if (size === null || size === undefined) {\n      this.textValue = math.unit('1m').toString();\n      this.size = math.unit('1m');\n    } else {\n      const valueProcessed = this.processValue(size);\n      if (valueProcessed !== false) {\n        this.textValue = valueProcessed.textValue;\n        this.size = valueProcessed.size;\n      } else {\n        this.textValue = math.unit('1m').toString();\n        this.size = math.unit('1m');\n      }\n    }\n\n    this.hitArea = new createjs.Shape();\n    this.hitArea.graphics\n      .beginFill(this.color)\n      .drawRect(-1, -1, this.nodeSize + 2, this.nodeSize + 2);\n    this.nodes = [new createjs.Shape(), new createjs.Shape()];\n    this.nodes[0].hitArea = this.hitArea;\n    this.nodes[1].hitArea = this.hitArea;\n    this.nodes[0].regX = this.nodeSize / 2;\n    this.nodes[1].regX = this.nodeSize / 2;\n    this.nodes[0].regY = this.nodeSize / 2;\n    this.nodes[1].regY = this.nodeSize / 2;\n    this.styleCommands = { colors: [] };\n    this.styleCommands.colors[0] = this.nodes[0].graphics.beginStroke(this.color).command;\n    this.styleCommands.colors[1] = this.nodes[1].graphics.beginStroke(this.color).command;\n    this.nodes[0].graphics.drawEllipse(0, 0, this.nodeSize, this.nodeSize);\n    this.nodes[1].graphics.drawEllipse(0, 0, this.nodeSize, this.nodeSize);\n    this.nodes[0].cursor = 'pointer';\n    this.nodes[1].cursor = 'pointer';\n    const scaled1 = this.project.toUnscaled(x1, y1);\n    const scaled2 = this.project.toUnscaled(x2, y2);\n    this.nodes[0].x = scaled1.x;\n    this.nodes[1].x = scaled2.x;\n    this.nodes[0].y = scaled1.y;\n    this.nodes[1].y = scaled2.y;\n\n    this.length = Math.sqrt(\n      Math.pow(this.positions[0].y - this.positions[1].y, 2) +\n        Math.pow(this.positions[0].x - this.positions[1].x, 2)\n    );\n    this.line = new createjs.Shape();\n    this.line.graphics.setStrokeStyle('2');\n    this.styleCommands.colors.push(this.line.graphics.beginStroke(this.color).command);\n    this.lineStart = this.line.graphics\n      .moveTo(this.nodes[0].x, this.nodes[0].y)\n      .command;\n    this.lineEnd = this.line.graphics.lineTo(this.nodes[1].x, this.nodes[1].y).command;\n    this.line.graphics.endStroke();\n\n    this.textSizingElement = document.createElement('span');\n    this.textSizingElement.innerText = this.textValue;\n    this.textSizingElement.classList.add('scale-text');\n    const mainContainer = document.getElementById('main-container');\n    if (mainContainer) mainContainer.appendChild(this.textSizingElement);\n    this.letterWidth =\n      this.textSizingElement.getBoundingClientRect().width / this.textValue.length;\n    this.textSizingElement.remove();\n\n    this.textElement = document.createElement('input');\n    if (mainContainer) mainContainer.appendChild(this.textElement);\n    this.textElement.classList.add('scale-text');\n    this.textElement.classList.add('not-editing');\n    this.textElement.type = 'text';\n    this.textElement.readOnly = true;\n    this.textElement.style.border = '2px ' + this.color + ' solid';\n    this.textElement.style.color = this.color;\n    this.textElement.style.width = this.letterWidth * this.textValue.length + 'px';\n    this.textElement.value = this.textValue;\n    this.text = new createjs.DOMElement(this.textElement);\n\n    this.textHitShape = new createjs.Shape();\n    this.textHit = this.textHitShape.graphics\n      .drawRect(\n        this.text.x - this.text.regX,\n        this.text.y - this.text.regY,\n        this.text.offsetWidth,\n        this.text.offsetHeight\n      )\n      .command;\n\n    this.stage.addChild(this.textHitShape);\n    this.stage.addChild(this.text);\n    this.stage.addChild(this.line);\n    this.stage.addChild(this.nodes[0]);\n    this.stage.addChild(this.nodes[1]);\n\n    this.update();\n    this.stage.update();\n    this.project.update();\n\n    const _scale = this;\n    this.textElement.addEventListener('focus', function () {\n      if (_scale.textElement.readOnly) {\n        _scale.textElement.blur();\n      }\n    });\n\n    ['startEditing', 'dblclick'].forEach(function (value) {\n      _scale.textElement.addEventListener(value, function () {\n        _scale.textElement.classList.add('editing');\n        _scale.textElement.classList.remove('not-editing');\n        _scale.textElement.readOnly = false;\n        _scale.textElement.value = math.format(_scale.size).toString();\n        _scale.update();\n      });\n    });\n\n    ['change', 'keypress', 'keyup'].forEach(function (value) {\n      _scale.textElement.addEventListener(value, function (e) {\n        if (\n          (value !== 'keypress' && value !== 'keyup') ||\n          (e as KeyboardEvent).key === '13'\n        ) {\n          _scale.update(_scale.textElement.value);\n          _scale.textElement.classList.remove('editing');\n          _scale.textElement.classList.add('not-editing');\n          _scale.textElement.blur();\n          _scale.textElement.readOnly = true;\n        } else {\n          _scale.update();\n        }\n      });\n    });\n    _scale.stage.addEventListener('click', function (e: createjs.MouseEvent) {\n      const mouseCoords = _scale.textHitShape.globalToLocal(e.stageX, e.stageY);\n      if (mouseCoords.x > _scale.textElement.offsetWidth) {\n        _scale.update(_scale.textElement.value);\n        _scale.textElement.classList.remove('editing');\n        _scale.textElement.classList.add('not-editing');\n        _scale.textElement.blur();\n        _scale.textElement.readOnly = true;\n      }\n    });\n\n    this.nodes[0].addEventListener('pressmove', function (e: createjs.MouseEvent) {\n      const coords = e.target.stage.globalToLocal(e.stageX, e.stageY);\n      _scale.nodes[0].x = coords.x;\n      _scale.nodes[0].y = coords.y;\n\n      const scaledCoord = _scale.project.toScaled(coords);\n      _scale.positions[0] = scaledCoord;\n\n      _scale.update();\n      _scale.stage.update();\n    });\n    this.nodes[1].addEventListener('pressmove', function (e: createjs.MouseEvent) {\n      const coords = e.target.stage.globalToLocal(e.stageX, e.stageY);\n      _scale.nodes[1].x = coords.x;\n      _scale.nodes[1].y = coords.y;\n\n      const scaledCoord = _scale.project.toScaled(coords);\n      _scale.positions[1] = scaledCoord;\n\n      _scale.update();\n      _scale.stage.update();\n    });\n\n    this.nodes[0].addEventListener('pressup', function () {\n      _scale.project.update();\n      _scale.project.changed();\n    });\n    this.nodes[1].addEventListener('pressup', function () {\n      _scale.project.update();\n      _scale.project.changed();\n    });\n  }\n\n  show(): void {\n    const mainContainer = document.getElementById('main-container');\n    if (mainContainer) mainContainer.appendChild(this.textElement);\n    this.stage.addChild(this.textHitShape);\n    this.stage.addChild(this.text);\n    this.stage.addChild(this.line);\n    this.stage.addChild(this.nodes[0]);\n    this.stage.addChild(this.nodes[1]);\n    this.update();\n  }\n\n  hide(): void {\n    this.stage.removeChild(this.textHitShape);\n    this.stage.removeChild(this.text);\n    this.stage.removeChild(this.line);\n    this.stage.removeChild(this.nodes[0]);\n    this.stage.removeChild(this.nodes[1]);\n    const mainContainer = document.getElementById('main-container');\n    if (mainContainer) mainContainer.removeChild(this.textElement);\n  }\n\n  updateInfo(data: Record<string, string>): void {\n    for (const key in data) {\n      switch (key) {\n        case 'color':\n          this.color = data[key];\n          this.textElement.style.color = this.color;\n          this.textElement.style.border = '2px ' + this.color + ' solid';\n          for (let i = 0; i < this.styleCommands.colors.length; i++) {\n            this.styleCommands.colors[i].style = this.color;\n          }\n          this.project.changed();\n          break;\n      }\n    }\n  }\n\n  unit(): string {\n    return this.size.units[0].unit.name;\n  }\n\n  processValue(value: string): ScaleProcessedValue | false {\n    const returnData: Partial<ScaleProcessedValue> = {};\n    if (value.length > 0) {\n      try {\n        if (value.split('>').length > 1) {\n          const split = value.split('>');\n          math.unit(split[0].trim());\n          returnData.size = math.unit(split[0].trim()).to(split[split.length - 1].trim());\n          returnData.textValue = math\n            .format(returnData.size, { notation: 'auto', precision: 6 })\n            .toString();\n        } else {\n          returnData.size = math.unit(value);\n          returnData.textValue = math\n            .format(math.unit(value), { notation: 'auto', precision: 6 })\n            .toString();\n        }\n      } catch {\n        return false;\n      }\n    } else {\n      return false;\n    }\n    return returnData as ScaleProcessedValue;\n  }\n\n  update(value: string = this.textValue): void {\n    const _scale = this;\n\n    if (value !== _scale.textValue) {\n      let valueProcessed = this.processValue(value);\n\n      if (!valueProcessed) {\n        valueProcessed = this.processValue(value.trim() + ' m');\n      }\n\n      if (valueProcessed !== false) {\n        if (valueProcessed.size.value !== null) {\n          const oldInfo = {\n            size: _scale.size,\n            textValue: _scale.textValue,\n          };\n\n          _scale.size = valueProcessed.size;\n          _scale.textValue = valueProcessed.textValue;\n\n          const newInfo = {\n            size: _scale.size,\n            textValue: _scale.textValue,\n          };\n\n          if (oldInfo.size.toString() !== newInfo.size.toString()) {\n            _scale.project.change({\n              undo: function () {\n                _scale.update(oldInfo.size.toString());\n              },\n              redo: function () {\n                _scale.update(newInfo.size.toString());\n              },\n            });\n          }\n          _scale.project.update();\n\n          _scale.textElement.value = _scale.textValue;\n        } else {\n          _scale.textElement.value = _scale.textValue;\n        }\n      } else {\n        _scale.textElement.value = _scale.textValue;\n      }\n    }\n\n    _scale.lineStart.x = _scale.nodes[1].x;\n    _scale.lineStart.y = _scale.nodes[1].y;\n    _scale.lineEnd.x = _scale.nodes[0].x;\n    _scale.lineEnd.y = _scale.nodes[0].y;\n    _scale.length = Math.sqrt(\n      Math.pow(_scale.positions[0].y - _scale.positions[1].y, 2) +\n        Math.pow(_scale.positions[0].x - _scale.positions[1].x, 2)\n    );\n\n    _scale.textElement.style.width =\n      _scale.letterWidth * _scale.textElement.value.length + 'px';\n\n    if (\n      (_scale.nodes[0].x < _scale.nodes[1].x && _scale.nodes[0].y < _scale.nodes[1].y) ||\n      (_scale.nodes[1].x < _scale.nodes[0].x && _scale.nodes[1].y < _scale.nodes[0].y)\n    ) {\n      _scale.text.regX = 0;\n      _scale.text.regY = _scale.textElement.offsetHeight;\n      _scale.text.x =\n        _scale.nodes[1].x + (_scale.nodes[0].x - _scale.nodes[1].x) / 2;\n      _scale.text.y =\n        _scale.nodes[1].y + (_scale.nodes[0].y - _scale.nodes[1].y) / 2;\n    } else {\n      _scale.text.regX = _scale.textElement.offsetWidth;\n      _scale.text.regY = _scale.textElement.offsetHeight;\n      _scale.text.x =\n        _scale.nodes[1].x + (_scale.nodes[0].x - _scale.nodes[1].x) / 2;\n      _scale.text.y =\n        _scale.nodes[1].y + (_scale.nodes[0].y - _scale.nodes[1].y) / 2;\n    }\n\n    if (\n      Math.abs(\n        (_scale.nodes[1].y - _scale.nodes[0].y) / (_scale.nodes[1].x - _scale.nodes[0].x)\n      ) < 0.4\n    ) {\n      _scale.text.regX = _scale.textElement.offsetWidth * 0.5;\n      _scale.text.regY = _scale.textElement.offsetHeight;\n      _scale.text.x =\n        _scale.nodes[1].x + (_scale.nodes[0].x - _scale.nodes[1].x) / 2;\n      _scale.text.y =\n        _scale.nodes[1].y + (_scale.nodes[0].y - _scale.nodes[1].y) / 2;\n    }\n\n    _scale.textHit.x = _scale.text.x - _scale.text.regX;\n    _scale.textHit.y = _scale.text.y - _scale.text.regY;\n    _scale.textHit.w = _scale.textElement.offsetWidth;\n    _scale.textHit.h = _scale.textElement.offsetHeight;\n    _scale.stage.update();\n  }\n\n  convert(\n    pixels: number,\n    unit: MathJsUnit = math.unit(this.unit())\n  ): { number: number } {\n    const mathUnit = math\n      .unit(\n        (math.multiply(pixels, math.divide(this.size, this.length) as number) as unknown as string)\n      )\n      .to(unit.toString());\n    return { number: mathUnit.toNumber(unit.toString()) };\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nimport type { Timeline } from './timeline';\nimport type { Point } from './point';\n\nexport class Frame {\n  time: number;\n  number: number;\n  timeline: Timeline;\n  uid: string;\n  points: Point[];\n\n  constructor(timeline: Timeline, time: number, number: number) {\n    this.time = time;\n    this.number = number;\n    this.timeline = timeline;\n    this.uid = (Math.round(Math.random() * 100000) + 1).toString();\n    this.points = [];\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nexport interface ModalFieldSchema {\n  label?: string;\n  type: string;\n  required?: boolean;\n  initVal?: string | number;\n  defaultValue?: string | number;\n  id?: string;\n  element?: HTMLDivElement;\n  picker?: CP;\n}\n\nexport interface ModalButtonSchema {\n  label: string;\n  image?: string;\n}\n\nexport interface ModalSchema {\n  name: string;\n  id: string;\n  fields: Record<string, ModalFieldSchema>;\n  buttons: Record<string, ModalButtonSchema>;\n  text?: string[];\n}\n\nexport type ModalExportData = Record<string, string> | false;\ntype ModalCallback = (this: Modal, data: ModalExportData) => void;\n\nexport class Modal {\n  name: string;\n  id: string;\n  fields: Record<string, ModalFieldSchema>;\n  buttons: Record<string, ModalButtonSchema>;\n  text: string[] | undefined;\n  callbacks: Record<string, ModalCallback[]>;\n  created: boolean;\n  defaultColors: string[];\n  element!: HTMLDivElement;\n  textContainer!: HTMLDivElement;\n\n  constructor(schema: ModalSchema, create = true) {\n    this.name = schema.name;\n    this.id = schema.id;\n    this.fields = schema.fields;\n    this.buttons = schema.buttons;\n    this.text = schema.text;\n    this.callbacks = {};\n    this.created = false;\n    this.defaultColors = [\n      '#FFFF00', '#FFFF33', '#F2EA02', '#E6FB04', '#FF0000', '#FD1C03',\n      '#FF3300', '#FF6600', '#00FF00', '#00FF33', '#00FF66', '#33FF00',\n      '#00FFFF', '#099FFF', '#0062FF', '#0033FF', '#FF00FF', '#FF00CC',\n      '#FF0099', '#CC00FF', '#9D00FF', '#CC00FF', '#6E0DD0', '#9900FF',\n    ];\n\n    if (create) {\n      this.create();\n    }\n  }\n\n  on(event: string, callback: ModalCallback): this {\n    const events = event.split(',');\n\n    for (let i = 0; i < events.length; i++) {\n      const tempEvent = events[i].trim();\n      if (this.callbacks[tempEvent] === undefined) this.callbacks[tempEvent] = [];\n\n      this.callbacks[tempEvent].push(callback);\n\n      if (tempEvent === 'create' && this.created) {\n        callback.call(this, this.export());\n      }\n    }\n    return this;\n  }\n\n  show(): this {\n    const container = document.getElementById('modal-container');\n    const element = document.getElementById(this.id);\n    if (container) container.classList.add('active');\n    if (element) element.classList.add('active');\n    return this;\n  }\n\n  hide(): this {\n    if ([...document.querySelectorAll('.modal.active')].length <= 1) {\n      const container = document.getElementById('modal-container');\n      if (container) container.classList.remove('active');\n    }\n    const element = document.getElementById(this.id);\n    if (element) element.classList.remove('active');\n    return this;\n  }\n\n  create(show = false): this {\n    const titleElement = document.createElement('div');\n    titleElement.classList.add('modal-title');\n    titleElement.innerText = this.name;\n\n    this.element = document.createElement('div');\n    this.element.classList.add('modal');\n    this.element.id = this.id;\n    this.element.appendChild(titleElement);\n\n    for (const field in this.fields) {\n      const formItem = document.createElement('div');\n      formItem.classList.add('form-item');\n      formItem.setAttribute('data-key', field);\n      const formInputId = this.id + '_input-' + field;\n      const formItemInput = document.createElement('input');\n      if (this.fields[field].type === 'color') {\n        formItemInput.type = 'text';\n        formItemInput.classList.add('colorpicker');\n        this.fields[field].picker = new CP(formItemInput);\n        this.fields[field].picker!.on('change', function (this: CP, color: string) {\n          this.target.value = '#' + color;\n          this.target.style.background = '#' + color;\n        });\n      } else {\n        formItemInput.type = this.fields[field].type;\n      }\n      formItemInput.name = formInputId;\n      formItemInput.id = formInputId;\n      formItemInput.setAttribute('data-key', field);\n      this.fields[field].id = formInputId;\n      this.fields[field].element = formItem;\n\n      if (\n        this.fields[field].defaultValue !== undefined &&\n        this.fields[field].initVal === undefined\n      ) {\n        this.fields[field].initVal = this.fields[field].defaultValue;\n      }\n\n      if (this.fields[field].initVal === undefined) {\n        if (this.fields[field].type === 'color') {\n          this.fields[field].initVal =\n            this.defaultColors[Math.floor(Math.random() * this.defaultColors.length)];\n        } else {\n          this.fields[field].initVal = '';\n        }\n      }\n      formItemInput.value = String(this.fields[field].initVal);\n      if (this.fields[field].type === 'color') {\n        formItemInput.style.background = String(this.fields[field].initVal);\n        this.fields[field].picker!.set(String(this.fields[field].initVal));\n      }\n\n      if (this.fields[field].type !== 'hidden') {\n        const formItemLabel = document.createElement('label');\n        formItemLabel.innerText = (this.fields[field].label || field) + ':';\n        formItemLabel.htmlFor = formInputId;\n        formItem.appendChild(formItemLabel);\n      }\n\n      formItem.appendChild(formItemInput);\n      this.element.appendChild(formItem);\n    }\n\n    if (this.text !== undefined) {\n      this.textContainer = document.createElement('div');\n      for (let i = 0; i < this.text.length; i++) {\n        const paragraph = document.createElement('p');\n        paragraph.innerHTML = this.text[i];\n        this.textContainer.appendChild(paragraph);\n      }\n      this.element.appendChild(this.textContainer);\n    }\n\n    const buttonContainer = document.createElement('div');\n    buttonContainer.classList.add('form-buttons');\n\n    for (const button in this.buttons) {\n      const buttonItem = document.createElement('button');\n      buttonItem.type = 'button';\n      buttonItem.id = this.id + '_button-' + button;\n      if (this.buttons[button].image !== undefined) {\n        buttonItem.title = this.buttons[button].label;\n        buttonItem.style.backgroundImage = \"url('\" + this.buttons[button].image + \"')\";\n      } else {\n        buttonItem.innerText = this.buttons[button].label;\n      }\n\n      const modalRef = this;\n      const buttonTemp = button;\n      buttonItem.addEventListener('click', function () {\n        modalRef.trigger(buttonTemp);\n      });\n      buttonContainer.appendChild(buttonItem);\n    }\n    this.element.appendChild(buttonContainer);\n\n    const modalContainer = document.getElementById('modal-container');\n    if (modalContainer) modalContainer.appendChild(this.element);\n\n    this.created = true;\n    this.trigger('create');\n\n    if (show) this.show();\n\n    return this;\n  }\n\n  trigger(event: string): void {\n    if (this.callbacks[event] !== undefined) {\n      for (let i = 0; i < this.callbacks[event].length; i++) {\n        this.callbacks[event][i].call(this, this.export());\n      }\n    }\n  }\n\n  export(): ModalExportData {\n    const exportData: Record<string, string> = {};\n    for (const field in this.fields) {\n      const fieldId = this.fields[field].id;\n      if (!fieldId) return false;\n      const el = document.getElementById(fieldId) as HTMLInputElement | null;\n      if (el && el.value.length > 0) {\n        exportData[field] = el.value;\n      } else {\n        return false;\n      }\n    }\n    return exportData;\n  }\n\n  clear(): this {\n    for (const field in this.fields) {\n      if (this.fields[field].initVal === undefined) this.fields[field].initVal = '';\n\n      const fieldId = this.fields[field].id;\n      if (fieldId) {\n        const el = document.getElementById(fieldId) as HTMLInputElement | null;\n        if (el) el.value = String(this.fields[field].initVal);\n      }\n    }\n    return this;\n  }\n\n  push(value: Record<string, string>): this {\n    for (const field in value) {\n      if (this.fields[field] !== undefined) {\n        const fieldId = this.fields[field].id;\n        if (fieldId) {\n          const el = document.getElementById(fieldId) as HTMLInputElement | null;\n          if (el) {\n            el.value = value[field];\n            if (this.fields[field].type === 'color') {\n              this.fields[field].picker!.set(value[field]);\n              el.style.background = value[field];\n            }\n          }\n        }\n      }\n    }\n    return this;\n  }\n}\n","/**\n * Shared global state module for jsTrack.\n * All modules import from here to access shared state.\n */\n\nimport './functions';\nimport { Project } from './classes/project';\nimport { Timeline } from './classes/timeline';\nimport { Modal } from './classes/modal';\n\n//  Constants \n\nexport const EXPORT_FORMATS = [\n  'xlsx', 'xlsm', 'xlsb', 'xls', 'ods', 'fods', 'csv', 'txt',\n  'sylk', 'html', 'dif', 'dbf', 'rtf', 'prn', 'eth',\n];\nexport const CUSTOM_EXTENSION = 'jstrack';\nexport const VIDEO_CONVERTOR = 'https://video.online-convert.com/convert-to-mp4';\nexport const GOOGLE_API_KEY = 'AIzaSyDIijziwMBTuCoKGMXhaVzBzUZibDVwiBM';\nexport const GOOGLE_CLIENT_ID = '44440188363-5vnafandpsrppr9189u7sc8q755oar9d';\n\nexport interface DistanceUnits {\n  fullUnits: string[];\n  abbreviations: string[];\n  unitNames: string[];\n  wordPrefixBig: string[];\n  abbrPrefixBig: string[];\n  wordPrefixSmall: string[];\n  abbrPrefixSmall: string[];\n}\n\nexport const distanceUnits: DistanceUnits = {\n  fullUnits: ['meter (m)', 'inch (in)', 'foot (ft)', 'yard (yd)', 'mile (mi)', 'link (li)', 'rod (rd)', 'chain (ch)', 'angstrom', 'mil'],\n  abbreviations: ['m', 'in', 'ft', 'yd', 'mi', 'li', 'rd', 'ch', 'angstrom', 'mil'],\n  unitNames: ['meter', 'inch', 'foot', 'yard', 'mile', 'link', 'rod', 'chain', 'angstrom', 'mil'],\n  wordPrefixBig: ['deca', 'hecto', 'kilo', 'mega', 'giga', 'tera', 'peta', 'exa', 'zetta', 'yotta'],\n  abbrPrefixBig: ['da', 'h', 'k', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y'],\n  wordPrefixSmall: ['deci', 'centi', 'milli', 'micro', 'nano', 'pico', 'femto', 'atto', 'zepto', 'yocto'],\n  abbrPrefixSmall: ['d', 'c', 'm', 'u', 'n', 'p', 'f', 'a', 'z', 'y'],\n};\n\n//  DOM Elements \n\nexport const sidebar = document.getElementById('sidebar') as HTMLDivElement;\nexport const videoContainer = document.getElementById('video-container') as HTMLDivElement;\nexport const canvas = document.getElementById('main') as HTMLCanvasElement;\n\n//  Stage & Background \n\nexport const stage = new createjs.Stage('main');\nexport const background = new createjs.Bitmap(\n  document.getElementById('video') as HTMLVideoElement\n);\nexport const background2 = new createjs.Bitmap(\n  document.getElementById('video-clone') as HTMLVideoElement\n);\nstage.addChild(background2);\nstage.addChild(background);\n\n//  Master project \n\nconst tableContainer = document.getElementById('table') as HTMLDivElement;\nexport const master = new Project(\n  'My Project',\n  new Timeline(canvas.width, canvas.height, document.getElementById('video') as HTMLVideoElement, 30),\n  new Handsontable(tableContainer),\n  stage,\n  background\n);\n\nmaster.timeline.video.addEventListener('loadstart', function (this: HTMLVideoElement) {\n  const clone = document.getElementById('video-clone') as HTMLVideoElement;\n  clone.src = this.src;\n  clone.pause();\n  clone.style.display = 'none';\n});\n\ntableContainer.querySelectorAll('table').forEach(function (el) {\n  el.id = 'data-table-master';\n});\n\nexport const video = master.timeline.video;\n\n//  Position Text \n\nexport const posTextBackground = new createjs.Shape();\nexport const posTextBackgroundCommand = posTextBackground.graphics\n  .beginFill('#000000')\n  .drawRect(0, 0, 200, 30).command;\nexport const posText = new createjs.Text('Frame: 0, X: 0, Y: 0', '13px Arial', '#FFF');\nposText.x = 10;\nposText.y = canvas.height - 15;\nstage.addChild(posTextBackground);\nstage.addChild(posText);\n\nstage.enableMouseOver();\n\ncreatejs.Ticker.addEventListener('tick', stage);\nstage.addEventListener('tick', function () {\n  if (master.created) master.timeline.update();\n});\n\n//  Modals \n\nexport const newProject = new Modal({\n  name: 'New Project',\n  id: 'new-project-modal',\n  fields: {\n    name: { label: 'Name', type: 'text', required: true },\n    framerate: { label: 'Framerate', type: 'number', required: true, initVal: '30' },\n    frameskip: { label: '# of frames to move', type: 'number', required: true, initVal: 1 },\n    videospeed: { label: 'Speed of video', type: 'number', required: true, initVal: 1 },\n    axesColor: { label: 'Axes Color', type: 'color', defaultValue: '#ff69b4', required: true },\n    pointsBackward: { label: 'Points Before Current Time', type: 'number', defaultValue: '7', required: true },\n    pointsForward: { label: 'Points Ahead of Current Time', type: 'number', defaultValue: '0', required: true },\n  },\n  buttons: { submit: { label: 'Create' } },\n});\n\nexport const saveProject = new Modal({\n  name: 'Save Project',\n  id: 'save-project-modal',\n  fields: {\n    filename: { label: 'Filename', type: 'text', required: true },\n  },\n  buttons: {\n    cancel: { label: 'Cancel' },\n    saveFile: { label: 'Save as File', image: 'icons/save_file_white.svg' },\n    saveDrive: { label: 'Save to Drive', image: 'icons/drive_white.svg' },\n  },\n});\n\nexport const editProject = new Modal({\n  name: 'Edit Project',\n  id: 'edit-project-modal',\n  fields: {\n    name: { label: 'Name', type: 'text', required: true },\n    frameskip: { label: '# of frames to move', type: 'number', required: true, initVal: 1 },\n    axesColor: { label: 'Axes Color', type: 'color', defaultValue: '#ff69b4', required: true },\n    pointsBackward: { label: 'Points Before Current Time', type: 'number', defaultValue: '7', required: true },\n    pointsForward: { label: 'Points Ahead of Current Time', type: 'number', defaultValue: '0', required: true },\n  },\n  buttons: { cancel: { label: 'Cancel' }, submit: { label: 'Save' } },\n});\n\nexport const exportData = new Modal({\n  name: 'Export Data',\n  id: 'export-modal',\n  fields: {\n    filename: { label: 'Filename', type: 'text', required: true },\n  },\n  buttons: { cancel: { label: 'Cancel' }, submit: { label: 'Export' } },\n});\n\nexport const newScale = new Modal({\n  name: 'New Scale',\n  id: 'new-scale',\n  fields: {\n    color: { label: 'Color', type: 'color', required: true },\n  },\n  buttons: { cancel: { label: 'Cancel' }, submit: { label: 'Create' } },\n});\n\nexport const editScale = new Modal({\n  name: 'Edit Scale',\n  id: 'edit-scale',\n  fields: {\n    color: { label: 'Color', type: 'color', required: true },\n  },\n  buttons: { cancel: { label: 'Cancel' }, submit: { label: 'Save' } },\n});\n\nexport const newTrack = new Modal({\n  name: 'New Track',\n  id: 'new-track',\n  fields: {\n    name: { label: 'Name', type: 'text', required: true },\n    color: { label: 'Color', type: 'color', required: true },\n  },\n  buttons: { cancel: { label: 'Cancel' }, submit: { label: 'Create' } },\n});\n\nexport const editTrack = new Modal({\n  name: 'Edit Track',\n  id: 'edit-track',\n  fields: {\n    name: { label: 'Name', type: 'text', required: true },\n    color: { label: 'Color', type: 'color', required: true },\n    uid: { type: 'hidden' },\n  },\n  buttons: { cancel: { label: 'Cancel' }, submit: { label: 'Save' } },\n});\n\n// Expose editTrack globally so Track class dblclick handler can access it\n(window as unknown as Record<string, unknown>)['editTrack'] = editTrack;\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nimport '../functions';\nimport { Timeline } from './timeline';\nimport { Track } from './track';\nimport { Axes, type Coordinate } from './axes';\nimport { Scale } from './scale';\nimport type { TableRowData } from './table';\n\ntype ProjectCallback = (this: Project, args: unknown[]) => void;\ntype ProjectModeCallback = (this: Project, mode: string, lastMode: string) => void;\ntype PositioningCallback = (this: Project, args: { event: string; delta?: number }) => void;\n\ninterface ProjectPositioning {\n  _zoom: number;\n  _x: number;\n  _y: number;\n  stuck: boolean;\n  autoZoom: boolean;\n  _callbacks: Record<string, PositioningCallback[]>;\n  zoom: number;\n  x: number;\n  y: number;\n  trigger(event: string, argArray?: { event?: string; delta?: number }): void;\n  on(event: string, callback: PositioningCallback): ProjectPositioning;\n}\n\ninterface ProjectState {\n  _mode: string;\n  _lastMode: string;\n  modeCallbacks: ProjectModeCallback[];\n  selectionCallbacks: Array<(selected: boolean) => void>;\n  mode: string;\n  triggerChange(): void;\n  reset(): void;\n  modeChange(val: ProjectModeCallback): void;\n  default(): void;\n}\n\ninterface SaveScaleData {\n  size: string;\n  color: string;\n  nodes: [Coordinate, Coordinate];\n}\n\ninterface SaveAxesData {\n  position: { x: number; y: number; rotation: number };\n  color: string;\n}\n\ninterface SaveTrackInfo {\n  name: string;\n  color: string;\n  points: Record<string, Coordinate>;\n  hidden: boolean;\n}\n\ninterface SaveData {\n  name: string;\n  duration: number;\n  video: HTMLVideoElement;\n  fps: number;\n  currentFrame: number;\n  uid: number;\n  startFrame: number;\n  endFrame: number;\n  videoName: string;\n  videoSpeed: number;\n  scale?: SaveScaleData;\n  axes?: SaveAxesData;\n  activeTrack?: string;\n  tracks?: Record<string, SaveTrackInfo>;\n}\n\ninterface MetaInfo {\n  date: string;\n  createdWith: string;\n  appVersion: number;\n  fileVersion: number;\n}\n\nexport interface ProjectSaveFile {\n  meta: MetaInfo;\n  project: SaveData;\n}\n\ninterface LoadFileData {\n  meta?: { fileVersion: number };\n  project?: Record<string, unknown>;\n  [key: string]: unknown;\n}\n\nexport class Project {\n  name: string;\n  created: boolean;\n  uid: number;\n  timeline: Timeline;\n  stage: createjs.Stage;\n  videoName: string;\n  addBackground: createjs.Shape;\n  background: createjs.Bitmap;\n  backgroundScale: number;\n  saved: boolean;\n  backedUp: boolean;\n  backUpDate: Date | null;\n  videoFile: File | Blob | null;\n  track: Track | null;\n  scale: Scale | null;\n  axes: Axes | null;\n  trackList: Record<string, Track>;\n  deletedTracks: Record<string, Track>;\n  axesList: Axes[];\n  callbacks: Record<string, ProjectCallback[]>;\n  undoManager: UndoManager;\n  saveIndex: number;\n  backUpIndex: number;\n  viewPoints: { forward: number; backward: number };\n  videoSpeed: number;\n  handsOnTable: Handsontable;\n  positioning: ProjectPositioning;\n  state: ProjectState;\n\n  constructor(\n    name: string,\n    timeline: Timeline,\n    handsOnTable: Handsontable,\n    stage: createjs.Stage,\n    background: createjs.Bitmap\n  ) {\n    this.name = name;\n    this.created = false;\n    this.uid = Math.random() * 100000000000000;\n    this.timeline = timeline;\n    this.stage = stage;\n    this.videoName = '';\n    this.addBackground = new createjs.Shape();\n    const hitArea = new createjs.Shape();\n    hitArea.graphics.beginFill('#000000');\n    hitArea.graphics.drawRect(-10000, -10000, 30000, 30000);\n    this.addBackground.hitArea = hitArea;\n    this.background = background;\n    this.backgroundScale = 0;\n    this.saved = true;\n    this.backedUp = true;\n    this.backUpDate = null;\n    this.videoFile = null;\n    this.track = null;\n    this.scale = null;\n    this.axes = null;\n    this.trackList = {};\n    this.deletedTracks = {};\n    this.axesList = [];\n    this.callbacks = {};\n    this.undoManager = new UndoManager();\n    this.saveIndex = this.backUpIndex = this.undoManager.getIndex();\n    this.viewPoints = {\n      forward: 0,\n      backward: 7,\n    };\n    this.videoSpeed = 1;\n    this.handsOnTable = handsOnTable;\n    this.handsOnTable.updateSettings({\n      readOnly: true,\n      autoColumnSize: true,\n      manualColumnResize: true,\n      manualColumnMove: true,\n      tableClassName: 'data-table-master',\n      rowHeaders: false,\n      colHeaders: true,\n      startRows: 3,\n      fixedColsLeft: 1,\n      preventOverflow: 'horizontal',\n      type: 'numeric',\n      stretchH: 'last',\n    });\n\n    const project = this;\n\n    this.positioning = {\n      _zoom: 1,\n      _x: 0,\n      _y: 0,\n      stuck: true,\n      autoZoom: true,\n      _callbacks: {},\n      get zoom(): number {\n        return this._zoom;\n      },\n      set zoom(value: number) {\n        const oldZoom = this._zoom;\n        this._zoom = value.roundTo(5);\n        this.autoZoom = false;\n        const zoomChange = this._zoom - oldZoom;\n\n        project.background.scale = project.backgroundScale * this._zoom;\n        (project.background as createjs.Bitmap & { w: number }).w =\n          project.background.scale * project.timeline.video.videoWidth;\n        (project.background as createjs.Bitmap & { h: number }).h =\n          project.background.scale * project.timeline.video.videoHeight;\n        project.updateScale();\n\n        if (oldZoom > this._zoom)\n          this.trigger('zoomout', { delta: zoomChange });\n        else this.trigger('zoomin', { delta: zoomChange });\n\n        this.trigger('zoom', { delta: zoomChange });\n      },\n      get x(): number {\n        return this._x;\n      },\n      set x(value: number) {\n        this._x = value.roundTo(5);\n\n        project.background.x = this._x;\n        project.updateScale();\n\n        this.trigger('translation');\n      },\n      get y(): number {\n        return this._y;\n      },\n      set y(value: number) {\n        this._y = value.roundTo(5);\n\n        project.background.y = this._y;\n        project.updateScale();\n\n        this.trigger('translation');\n      },\n      trigger(event: string, argArray: { event?: string; delta?: number } = {}) {\n        argArray.event = event;\n        if (this._callbacks[event] !== undefined) {\n          const callbacks = this._callbacks[event];\n          for (let i = 0; i < callbacks.length; i++) {\n            callbacks[i].call(project, argArray as { event: string; delta?: number });\n          }\n        }\n      },\n      on(event: string, callback: PositioningCallback) {\n        const events = event.split(',');\n        for (let i = 0; i < events.length; i++) {\n          const tempEvent = events[i].trim();\n\n          if (this._callbacks[tempEvent] === undefined) {\n            this._callbacks[tempEvent] = [];\n          }\n\n          this._callbacks[tempEvent].push(callback);\n        }\n        return this;\n      },\n    };\n\n    this.state = {\n      _mode: 'default',\n      _lastMode: '',\n      modeCallbacks: [],\n      selectionCallbacks: [],\n      set mode(val: string) {\n        if (this._mode !== val) {\n          this._lastMode = this._mode;\n          this._mode = val;\n        }\n        this.triggerChange();\n      },\n      get mode(): string {\n        return this._mode;\n      },\n      triggerChange() {\n        for (let i = 0; i < this.modeCallbacks.length; i++) {\n          this.modeCallbacks[i].call(project, this._mode, this._lastMode);\n        }\n      },\n      reset() {\n        const tempLastMode = this._lastMode;\n        this._lastMode = this._mode;\n        this._mode = tempLastMode;\n        this.triggerChange();\n      },\n      modeChange(val: ProjectModeCallback) {\n        this.modeCallbacks.push(val);\n      },\n      default() {\n        this._mode = 'default';\n        this.triggerChange();\n      },\n    };\n\n    this.state.modeChange(function (this: Project, mode: string) {\n      if (mode === 'add') {\n        if (this.axes !== null && this.axes !== undefined) {\n          this.axes.hide();\n        }\n        if (this.scale !== null && this.scale !== undefined) {\n          this.scale.hide();\n        }\n      } else {\n        if (this.axes !== null && this.axes !== undefined) {\n          this.axes.show();\n        }\n        if (this.scale !== null && this.scale !== undefined) {\n          this.scale.show();\n        }\n      }\n\n      switch (mode) {\n        case 'seek':\n          this.stage.removeChild(this.addBackground);\n          this.stage.cursor = 'crosshair';\n          break;\n        case 'add':\n        case 'newScale':\n          this.stage.addChild(this.addBackground);\n          switch (platform.name) {\n            case 'Firefox':\n              this.stage.cursor = \"url('icons/add_point.png') 16 16, copy\";\n              break;\n            case 'Chrome':\n              this.stage.cursor = \"url('icons/add_point.png') 8 8, copy\";\n              break;\n            default:\n              this.stage.cursor = 'copy';\n              break;\n          }\n          break;\n        case 'positioning':\n          this.stage.addChild(this.addBackground);\n          this.stage.cursor = 'move';\n          break;\n        default:\n          this.stage.removeChild(this.addBackground);\n          this.stage.cursor = 'default';\n          this.updateVisiblePoints();\n          break;\n      }\n      this.stage._testMouseOver(true);\n    });\n\n    this.timeline.project = this;\n  }\n\n  toUnscaled(x: number | Coordinate, y: number | null = null): Coordinate {\n    let xNum: number;\n    let yNum: number;\n    if (typeof x === 'object') {\n      xNum = x.x;\n      yNum = y !== null ? y : x.y;\n    } else {\n      xNum = x;\n      yNum = y !== null ? y : 0;\n    }\n\n    const changing = {\n      width:\n        this.timeline.video.videoWidth * (this.backgroundScale * this.positioning.zoom),\n      height:\n        this.timeline.video.videoHeight * (this.backgroundScale * this.positioning.zoom),\n    };\n    const unchanging = {\n      width: this.timeline.video.videoWidth,\n      height: this.timeline.video.videoHeight,\n    };\n    const translation = {\n      x: this.positioning.x,\n      y: this.positioning.y,\n    };\n\n    return {\n      x: (xNum / unchanging.width) * changing.width + translation.x,\n      y: (yNum / unchanging.height) * changing.height + translation.y,\n    };\n  }\n\n  toScaled(x: number | Coordinate, y: number | null = null): Coordinate {\n    let xNum: number;\n    let yNum: number;\n    if (typeof x === 'object') {\n      xNum = x.x;\n      yNum = y !== null ? y : x.y;\n    } else {\n      xNum = x;\n      yNum = y !== null ? y : 0;\n    }\n\n    const changing = {\n      width:\n        this.timeline.video.videoWidth * (this.backgroundScale * this.positioning.zoom),\n      height:\n        this.timeline.video.videoHeight * (this.backgroundScale * this.positioning.zoom),\n    };\n    const unchanging = {\n      width: this.timeline.video.videoWidth,\n      height: this.timeline.video.videoHeight,\n    };\n    const translation = {\n      x: this.positioning.x,\n      y: this.positioning.y,\n    };\n\n    return {\n      x: ((xNum - translation.x) / changing.width) * unchanging.width,\n      y: ((yNum - translation.y) / changing.height) * unchanging.height,\n    };\n  }\n\n  updateScale(): void {\n    if (this.axes !== undefined && this.axes !== null) {\n      const moveTo = this.toUnscaled(this.axes.x, this.axes.y);\n      this.axes.shape.x = moveTo.x;\n      this.axes.shape.y = moveTo.y;\n    }\n    for (let i = 0; i < this.timeline.frames.length; i++) {\n      const frame = this.timeline.frames[i];\n      for (let j = 0; j < frame.points.length; j++) {\n        const point = frame.points[j];\n        const scaled = this.toUnscaled(point.x, point.y);\n        point.shape.x = point.circle.x = scaled.x;\n        point.shape.y = point.circle.y = scaled.y;\n      }\n    }\n    if (this.scale !== undefined && this.scale !== null) {\n      const moveTo = [\n        this.toUnscaled(this.scale.positions[0]),\n        this.toUnscaled(this.scale.positions[1]),\n      ];\n      this.scale.nodes[0].x = moveTo[0].x;\n      this.scale.nodes[0].y = moveTo[0].y;\n      this.scale.nodes[1].x = moveTo[1].x;\n      this.scale.nodes[1].y = moveTo[1].y;\n      this.scale.update();\n    }\n  }\n\n  undo(): void {\n    this.undoManager.undo();\n    if (this.saveIndex !== this.undoManager.getIndex()) {\n      this.saved = false;\n      this.trigger('change');\n    }\n    if (this.backUpIndex !== this.undoManager.getIndex()) {\n      this.backedUp = false;\n      this.trigger('change');\n    }\n    this.trigger('undo');\n  }\n\n  redo(): void {\n    this.undoManager.redo();\n    if (this.saveIndex !== this.undoManager.getIndex()) {\n      this.saved = false;\n      this.trigger('change');\n    }\n    if (this.backUpIndex !== this.undoManager.getIndex()) {\n      this.backedUp = false;\n      this.trigger('change');\n    }\n    this.trigger('redo');\n  }\n\n  backup(): void {\n    this.backedUp = true;\n    this.backUpDate = new Date();\n    this.backUpIndex = this.undoManager.getIndex();\n  }\n\n  on(events: string, callback: ProjectCallback): this {\n    const eventList = events.split(',');\n    for (let i = 0; i < eventList.length; i++) {\n      const event = eventList[i].trim();\n      if (this.callbacks[event] === undefined) {\n        this.callbacks[event] = [];\n      }\n      this.callbacks[event].push(callback);\n    }\n    return this;\n  }\n\n  trigger(events: string, argArray: unknown[] = []): this {\n    const eventList = events.split(',');\n    for (let i = 0; i < eventList.length; i++) {\n      const event = eventList[i].trim();\n      if (this.callbacks[event] !== undefined) {\n        for (let j = 0; j < this.callbacks[event].length; j++) {\n          this.callbacks[event][j].call(this, argArray);\n        }\n      }\n    }\n    return this;\n  }\n\n  changed(): this {\n    this.saved = false;\n    this.backedUp = false;\n    this.trigger('change');\n    return this;\n  }\n\n  change(actions: { undo: () => void; redo: () => void }): this {\n    this.saved = false;\n    this.backedUp = false;\n\n    this.undoManager.add({\n      undo: actions.undo,\n      redo: actions.redo,\n    });\n\n    this.trigger('change');\n\n    return this;\n  }\n\n  updateVisiblePoints(): this {\n    if (this.state.mode !== 'add') {\n      for (let i = 0; i < this.timeline.activeFrames.length; i++) {\n        const frame = this.timeline.activeFrames[i];\n        if (\n          frame.number <\n            this.timeline.currentFrame -\n              this.viewPoints.backward * this.timeline.frameSkip ||\n          frame.number >\n            this.timeline.currentFrame +\n              this.viewPoints.forward * this.timeline.frameSkip ||\n          frame.number < this.timeline.startFrame ||\n          frame.number > this.timeline.endFrame\n        ) {\n          for (let j = 0; j < frame.points.length; j++) {\n            if (!frame.points[j].hidden) {\n              frame.points[j].hide();\n            }\n          }\n        } else {\n          for (let j = 0; j < frame.points.length; j++) {\n            if (frame.points[j].hidden) {\n              frame.points[j].show();\n            }\n          }\n        }\n      }\n      if (this.track !== undefined && this.track !== null) {\n        if (this.track.emphasizedPoint !== null && this.track.emphasizedPoint !== undefined) {\n          this.track.emphasizedPoint.emphasize();\n        }\n      }\n    }\n    return this;\n  }\n\n  destroy(): this {\n    for (const uid in this.trackList) {\n      const track = this.trackList[uid];\n      track.listElement.container.remove();\n    }\n    if (this.scale !== null && this.scale !== undefined) this.scale.textElement.remove();\n\n    this.handsOnTable.destroy();\n    return this;\n  }\n\n  save(): ProjectSaveFile {\n    const metaInfo: MetaInfo = {\n      date: new Date().toString(),\n      createdWith: 'Created with JSTrack by Luca Demian',\n      appVersion: 0.1,\n      fileVersion: 0.3,\n    };\n\n    const saveData: SaveData = {\n      name: this.name,\n      duration: this.timeline.duration,\n      video: this.timeline.video,\n      fps: this.timeline.fps,\n      currentFrame: this.timeline.currentFrame,\n      uid: this.uid,\n      startFrame: this.timeline.startFrame,\n      endFrame: this.timeline.endFrame,\n      videoName: this.videoName,\n      videoSpeed: this.videoSpeed,\n    };\n\n    if (this.scale !== null && this.scale !== undefined) {\n      saveData.scale = {\n        size: this.scale.size.toString(),\n        color: this.scale.color,\n        nodes: [\n          { x: this.scale.positions[0].x, y: this.scale.positions[0].y },\n          { x: this.scale.positions[1].x, y: this.scale.positions[1].y },\n        ],\n      };\n    }\n\n    if (this.axes !== null && this.axes !== undefined) {\n      saveData.axes = {\n        position: { x: this.axes.x, y: this.axes.y, rotation: this.axes.theta },\n        color: this.axes.color,\n      };\n    }\n\n    if (this.track !== null && this.track !== undefined)\n      saveData.activeTrack = this.track.uid;\n\n    saveData.tracks = {};\n    for (const uid in this.trackList) {\n      const track = this.trackList[uid];\n      const trackInfo: SaveTrackInfo = {\n        name: track.name,\n        color: track.color,\n        points: {},\n        hidden: track.hidden,\n      };\n\n      for (const number in track.points) {\n        trackInfo.points[number] = {\n          x: track.points[number].x,\n          y: track.points[number].y,\n        };\n      }\n\n      saveData.tracks[uid] = trackInfo;\n    }\n\n    return { meta: metaInfo, project: saveData };\n  }\n\n  load(fileData: LoadFileData): this {\n    let version = 0;\n    const fileInfo = fileData['meta'];\n\n    let data: Record<string, unknown>;\n    if (fileInfo !== undefined) {\n      version = fileInfo['fileVersion'];\n      if (version > 0) {\n        data = (fileData['project'] as Record<string, unknown>) || fileData;\n      } else {\n        data = fileData as Record<string, unknown>;\n      }\n    } else {\n      data = fileData as Record<string, unknown>;\n    }\n\n    if (data.fps !== undefined) {\n      this.timeline.updateTiming(this.timeline.video.duration, data.fps as number);\n      if (this.timeline.frames.length === 1) {\n        this.timeline.createFrames();\n      }\n      this._load(data, version);\n    } else {\n      const project = this;\n      this.timeline.detectFrameRate(function (fps: number) {\n        project.timeline.updateTiming(project.timeline.video.duration, fps);\n        if (project.timeline.frames.length === 1) {\n          project.timeline.createFrames();\n        }\n\n        project._load(data, version);\n      });\n    }\n\n    return this;\n  }\n\n  _load(data: Record<string, unknown>, version: number): void {\n    for (const key in data) {\n      const value = data[key];\n      switch (key) {\n        case 'name':\n          this.name = value as string;\n          break;\n        case 'uid':\n          this.uid = value as number;\n          break;\n        case 'videoName':\n          this.videoName = value as string;\n          break;\n        case 'videoSpeed':\n          this.videoSpeed = value as number;\n          break;\n        case 'currentFrame':\n          this.timeline.seek(value as number);\n          break;\n        case 'startFrame':\n          this.timeline.startFrame = value as number;\n          break;\n        case 'endFrame':\n          this.timeline.endFrame = value as number;\n          break;\n        case 'scale': {\n          const scaleData = value as SaveScaleData;\n          this.newScale(\n            scaleData.size,\n            scaleData.nodes[0].x,\n            scaleData.nodes[0].y,\n            scaleData.nodes[1].x,\n            scaleData.nodes[1].y,\n            scaleData.color,\n            true\n          );\n          break;\n        }\n        case 'axes': {\n          const axesData = value as SaveAxesData;\n          const axes = this.newAxes(\n            axesData.position.x,\n            axesData.position.y,\n            axesData.color,\n            true\n          );\n          if (version > 0) {\n            axes.rotate(axesData.position.rotation);\n          }\n          break;\n        }\n        case 'tracks': {\n          const tracksData = value as Record<string, SaveTrackInfo>;\n          for (const uid in tracksData) {\n            const trackInfo = tracksData[uid];\n            const track = this.newTrack(trackInfo.name, trackInfo.color, false, uid);\n            for (const number in trackInfo.points) {\n              const frame = this.timeline.frames[Number(number)];\n              if (frame !== undefined)\n                track.addPoint(frame, trackInfo.points[number].x, trackInfo.points[number].y);\n            }\n            track.unselectAll();\n            if (version > 0.2) {\n              if (trackInfo.hidden) track.hide();\n            }\n          }\n          break;\n        }\n      }\n      if (data['activeTrack'] !== undefined && data['activeTrack'] !== null) {\n        this.switchTrack(data['activeTrack'] as string);\n      }\n    }\n\n    this.updateVisiblePoints();\n    this.created = true;\n    this.trigger('created');\n    this.undoManager.clear();\n  }\n\n  deleteTrack(uid: string): void {\n    if (this.trackList[uid] !== undefined) {\n      const track = this.trackList[uid];\n      this.deletedTracks[uid] = track;\n      for (const number in track.points) {\n        const point = track.points[number];\n        point.unemphasize();\n        point.unselect();\n        track.stage.removeChild(point.shape);\n        for (let i = 0; i < point.frame.points.length; i++) {\n          if (point.frame.points[i] === point) {\n            point.frame.points.splice(i, 1);\n            i--;\n          }\n        }\n      }\n      if (this.track === track) {\n        this.track = null;\n      }\n      track.listElement.container.remove();\n\n      delete this.trackList[uid];\n\n      this.trigger('deleteTrack', [track]);\n    }\n  }\n\n  undeleteTrack(uid: string): void {\n    if (this.deletedTracks[uid] !== undefined) {\n      const track = this.deletedTracks[uid];\n      this.trackList[uid] = track;\n      const trackListUl = document.getElementById('track-list')?.querySelector('ul');\n      if (trackListUl) trackListUl.appendChild(track.listElement.container);\n      for (const number in track.points) {\n        const point = track.points[number];\n        point.unemphasize();\n        point.unselect();\n        point.show();\n\n        point.frame.points.push(point);\n      }\n      this.updateVisiblePoints();\n      this.switchTrack(uid);\n      delete this.deletedTracks[uid];\n\n      this.trigger('undeleteTrack', [track]);\n    }\n  }\n\n  newTrack(\n    name: string,\n    color: string,\n    makeDefault = true,\n    uid: string | false = false\n  ): Track {\n    const project = this;\n    const track = new Track(this, this.timeline, name, color, this.stage, uid);\n\n    this.change({\n      undo: function () {\n        project.deleteTrack(track.uid);\n      },\n      redo: function () {\n        project.undeleteTrack(track.uid);\n      },\n    });\n\n    this.trackList[track.uid] = track;\n    if (makeDefault) {\n      this.track = track;\n      this.track.select();\n    }\n    track.table.makeActive();\n\n    this.trigger('newTrack', [track]);\n\n    return track;\n  }\n\n  newAxes(x: number, y: number, color: string, makeDefault = true): Axes {\n    const axes = new Axes(this.stage, x, y, color, this);\n    this.axesList.push(axes);\n    if (makeDefault) this.axes = axes;\n\n    return axes;\n  }\n\n  newScale(\n    size: string | null,\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    color = '#39ff14',\n    makeDefault = true\n  ): Scale {\n    const project = this;\n    const scale = new Scale(this.stage, size, x1, y1, x2, y2, color, this);\n\n    this.change({\n      undo: function () {\n        project.deleteScale(scale.uid);\n      },\n      redo: function () {\n        project.newScale(size, x1, y1, x2, y2, color, makeDefault);\n      },\n    });\n\n    if (makeDefault) this.scale = scale;\n\n    this.trigger('newScale', [scale]);\n\n    return scale;\n  }\n\n  deleteScale(uid: string): void {\n    if (this.scale && this.scale.uid === uid) {\n      this.scale.hide();\n      this.scale = null;\n    }\n  }\n\n  switchTrack(uid: string): this {\n    if (this.trackList[uid] !== undefined) {\n      if (this.track !== null && this.track !== undefined) {\n        this.track.unselectAll();\n        this.track.unemphasizeAll();\n      }\n\n      this.track = this.trackList[uid];\n      this.track.select();\n      this.track.table.makeActive();\n\n      let tableData: TableRowData[] = this.track.export().points.scaled;\n      if (tableData.length === 0) tableData = [{ '': '' }];\n      this.track.table.newData(tableData, true, true);\n\n      if (this.track.points[this.timeline.currentFrame] !== undefined) {\n        this.track.points[this.timeline.currentFrame].emphasize();\n      }\n    }\n    return this;\n  }\n\n  update(): this {\n    for (const uid in this.trackList) {\n      const track = this.trackList[uid];\n\n      if (this.scale === null || this.scale === undefined) {\n        track.unit = 'px';\n      } else {\n        track.scale = this.scale;\n\n        if (track.unit !== this.scale.unit().toString()) {\n          track.unit = this.scale.unit().toString();\n          track.table.newCols({ t: 's', x: track.unit, y: track.unit });\n        }\n      }\n    }\n    if (this.track !== null && this.track !== undefined) {\n      let tableData: TableRowData[] = this.track.export().points.scaled;\n      if (tableData.length === 0) tableData = [{ '': '' }];\n      this.track.table.newData(tableData, true, true);\n    }\n    return this;\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * any later version.\n */\n\nimport '../functions';\nimport { Frame } from './frame';\nimport type { Project } from './project';\n\ntype TimelineCallback = (this: Timeline, args: unknown[]) => void;\n\nexport class Timeline {\n  duration: number;\n  video: HTMLVideoElement;\n  width: number;\n  height: number;\n  fps: number;\n  frameSkip: number;\n  frameTime: number;\n  frameCount: number;\n  currentTime: number;\n  currentFrame: number;\n  lastFrame: number;\n  direction: 'forward' | 'backward';\n  savedTime: number;\n  savedFrame!: number;\n  seekSaved: boolean;\n  startFrame: number;\n  endFrame: number;\n  callbacks: Record<string, TimelineCallback[]>;\n  frames: Frame[];\n  activeFrames: Frame[];\n  playInterval: ReturnType<typeof setInterval> | undefined;\n  project!: Project;\n\n  constructor(width: number, height: number, video: HTMLVideoElement, fps: number) {\n    this.duration = video.duration.roundTo(3);\n    this.video = video;\n    this.width = width;\n    this.height = height;\n    this.fps = fps;\n    this.frameSkip = 1;\n    this.frameTime = (1 / this.fps).roundTo(3);\n    this.frameCount = Math.floor(this.duration / this.frameTime);\n    this.currentTime = 0;\n    this.currentFrame = 0;\n    this.lastFrame = -1;\n    this.direction = 'forward';\n    this.savedTime = 0;\n    this.seekSaved = false;\n    this.startFrame = 0;\n    this.endFrame = 1;\n    this.callbacks = {};\n    this.frames = [new Frame(this, 0, 0)];\n    this.activeFrames = [];\n  }\n\n  createFrames(): void {\n    let counter = 1;\n    for (\n      let time = this.frameTime;\n      time <= this.video.duration;\n      time = (time + this.frameTime).roundTo(3)\n    ) {\n      this.frames[counter] = new Frame(this, time, counter);\n      counter++;\n    }\n  }\n\n  trigger(events: string, argArray: unknown[] = []): void {\n    const eventList = events.split(',');\n    for (let i = 0; i < eventList.length; i++) {\n      const event = eventList[i].trim();\n      if (this.callbacks[event] !== undefined) {\n        for (let j = 0; j < this.callbacks[event].length; j++) {\n          this.callbacks[event][j].call(this, argArray);\n        }\n      }\n    }\n  }\n\n  on(events: string, callback: TimelineCallback): void {\n    const eventList = events.split(',');\n    for (let i = 0; i < eventList.length; i++) {\n      const event = eventList[i].trim();\n      if (this.callbacks[event] === undefined) {\n        this.callbacks[event] = [];\n      }\n      this.callbacks[event].push(callback);\n    }\n  }\n\n  detectFrameRate(callback: ((fps: number) => void) | null = null): void {\n    const frameTime = 1 / 240;\n    let frame: string | null = null;\n    const tempVideo = document.createElement('video');\n    let firstLoad = true;\n    tempVideo.onloadeddata = function () {\n      if (firstLoad) {\n        firstLoad = false;\n        tempVideo.currentTime = tempVideo.duration;\n        const newCanv = document.createElement('canvas');\n        newCanv.height = tempVideo.videoHeight;\n        newCanv.width = tempVideo.videoWidth;\n        const newCtx = newCanv.getContext('2d');\n        if (!newCtx) return;\n        newCtx.drawImage(tempVideo, 0, 0, newCanv.width, newCanv.height);\n\n        let tempTime = 0;\n        tempVideo.currentTime = tempTime;\n        let startFrame = newCanv.toDataURL();\n        console.log('Detecting Framerate...');\n        let matchCount = 0;\n        let startFrameTime = 0;\n        tempVideo.addEventListener('timeupdate', function () {\n          newCtx.drawImage(tempVideo, 0, 0, newCanv.width, newCanv.height);\n          if (tempTime === 0) startFrame = newCanv.toDataURL();\n\n          frame = newCanv.toDataURL();\n\n          if (frame !== startFrame && matchCount === 0) {\n            startFrameTime = tempTime;\n            startFrame = frame;\n            tempTime += frameTime;\n            matchCount++;\n            tempVideo.currentTime = tempTime;\n          } else if (frame !== startFrame && matchCount === 1) {\n            matchCount++;\n            let framerate = (\n              (tempVideo.duration / (tempTime - startFrameTime)) /\n              tempVideo.duration\n            ).roundTo(2);\n\n            if (platform.name === 'Firefox' && framerate === 34.29) framerate = 30;\n            console.log(framerate + ' FPS');\n            if (callback !== null) callback(framerate);\n          } else {\n            tempTime += frameTime;\n            tempVideo.currentTime = tempTime;\n          }\n        });\n      }\n    };\n    tempVideo.src = this.video.src;\n  }\n\n  currentImage(): HTMLImageElement {\n    return this.getImage();\n  }\n\n  getImage(time: number = this.currentTime): HTMLImageElement {\n    const lastTime = this.currentTime;\n    this.video.currentTime = time;\n    const canvas = document.createElement('canvas');\n    canvas.height = this.video.videoHeight;\n    canvas.width = this.video.videoWidth;\n    const ctx = canvas.getContext('2d');\n    if (ctx) ctx.drawImage(this.video, 0, 0, canvas.width, canvas.height);\n    const img = new Image();\n    img.src = canvas.toDataURL();\n    this.video.currentTime = lastTime;\n    return img;\n  }\n\n  play(callback: (() => void) | null = null, options: Record<string, number | boolean> = {}): void {\n    if (this.playInterval === undefined) {\n      this.trigger('play');\n      let loop = true;\n      let startingTime = this.currentTime;\n      let startingFrame = this.startFrame;\n      let endingFrame = this.endFrame;\n      const speed = 1;\n\n      for (const key in options) {\n        const value = options[key];\n        switch (key) {\n          case 'loop':\n            loop = value as boolean;\n            break;\n          case 'startTime':\n          case 'startingTime':\n            if ((value as number) > 0 && (value as number) < this.duration)\n              startingTime = value as number;\n            break;\n          case 'startFrame':\n          case 'startingFrame':\n            if ((value as number) >= 0 && (value as number) < this.frameCount)\n              startingFrame = value as number;\n            break;\n          case 'endFrame':\n          case 'endingFrame':\n            if ((value as number) > 0 && (value as number) <= this.frameCount)\n              endingFrame = value as number;\n            break;\n        }\n      }\n\n      this.currentTime = startingTime;\n      let counter = startingFrame;\n      const timeline = this;\n\n      this.playInterval = setInterval(function () {\n        if (counter <= endingFrame) {\n          const next = timeline.next();\n          if (next !== false) {\n            timeline.setFrame(next.number);\n            counter = next.number;\n            if (counter === endingFrame) counter = endingFrame + 100;\n          }\n        } else {\n          timeline.setFrame(startingFrame);\n          counter = startingFrame;\n        }\n        timeline.project.updateVisiblePoints();\n        if (timeline.project.track !== undefined && timeline.project.track !== null) {\n          if (timeline.project.track.points[timeline.currentFrame] !== undefined) {\n            timeline.project.track.unemphasizeAll();\n            timeline.project.track.points[timeline.currentFrame].emphasize();\n          }\n        }\n      }, 200 / speed);\n    }\n  }\n\n  pause(): void {\n    clearInterval(this.playInterval);\n    this.playInterval = undefined;\n    this.trigger('pause');\n  }\n\n  seek(frame: number): this {\n    this.savedFrame = frame;\n    this.seekSaved = true;\n    return this;\n  }\n\n  update(): void {\n    if (this.seekSaved && this.duration > 0) {\n      this.lastFrame = this.currentFrame;\n      this.currentFrame = this.savedFrame;\n      this.seekSaved = false;\n\n      if (this.lastFrame < this.currentFrame) this.direction = 'forward';\n      else this.direction = 'backward';\n\n      this.currentTime = (this.currentFrame * this.frameTime).roundTo(3);\n\n      this.trigger('seek');\n    } else {\n      this.currentTime = (this.currentFrame * this.frameTime).roundTo(3);\n    }\n\n    if (this.video.currentTime !== this.currentTime) {\n      this.video.currentTime = this.currentTime;\n    }\n  }\n\n  updateTiming(duration: number, fps: number | string): number {\n    const ratios = {\n      start: this.startFrame / this.frameCount || 0,\n      end: this.endFrame / this.frameCount || 1,\n    };\n    this.duration = duration.roundTo(3);\n    this.fps = parseFloat(String(fps));\n    this.frameTime = (1 / this.fps).roundTo(3);\n    this.frameCount = Math.floor(this.duration / this.frameTime);\n    this.duration = (this.frameCount * this.frameTime).roundTo(3);\n    this.startFrame = Math.floor(ratios.start * this.frameCount);\n    this.endFrame = Math.floor(ratios.end * this.frameCount);\n    this.trigger('timingUpdate');\n    return this.duration;\n  }\n\n  current(): Frame | false {\n    if (this.frames[this.currentFrame] !== undefined) {\n      return this.frames[this.currentFrame];\n    } else {\n      return false;\n    }\n  }\n\n  setFrame(frameNum: number): void | false {\n    const frame = this.frames[frameNum];\n    if (frame !== undefined) {\n      this.lastFrame = this.currentFrame;\n      this.currentFrame = frame.number;\n      this.currentTime = frame.time.roundTo(3);\n      this.video.currentTime = frame.time;\n\n      if (this.lastFrame < this.currentFrame) this.direction = 'forward';\n      else this.direction = 'backward';\n\n      this.trigger('seek');\n    } else {\n      return false;\n    }\n  }\n\n  getClosestFrame(time: number = this.currentTime): number {\n    return Math.floor((time / this.frameTime).roundTo(3));\n  }\n\n  getFrameStart(frameNum: number): number {\n    return (this.frameTime * frameNum).roundTo(3);\n  }\n\n  next(): Frame | false {\n    let nextFrameNum = this.currentFrame + this.frameSkip;\n    if (this.currentFrame % this.frameSkip !== 0) {\n      nextFrameNum -= this.currentFrame % this.frameSkip;\n    }\n\n    if (nextFrameNum > this.endFrame) {\n      nextFrameNum = this.endFrame;\n    }\n\n    const pickedFrame = this.frames[nextFrameNum];\n    if (pickedFrame === undefined) {\n      return false;\n    } else {\n      return pickedFrame;\n    }\n  }\n\n  prev(): Frame | false {\n    let prevFrameNum = this.currentFrame - this.frameSkip;\n    if (this.currentFrame % this.frameSkip !== 0) {\n      prevFrameNum += this.frameSkip - (this.currentFrame % this.frameSkip);\n    }\n\n    if (prevFrameNum < this.startFrame) {\n      prevFrameNum = this.currentFrame - (this.frameCount % this.frameSkip);\n    }\n\n    const pickedFrame = this.frames[prevFrameNum];\n    if (pickedFrame === undefined) {\n      return false;\n    } else {\n      return pickedFrame;\n    }\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { master } from './globals';\n\nexport function setStorage(key: string, value: string): void {\n  localStorage.setItem(key, value);\n}\n\nexport function getStorage(key: string): string | null {\n  return localStorage.getItem(key);\n}\n\nexport function deleteStorage(key: string): void {\n  localStorage.removeItem(key);\n}\n\nwindow.addEventListener('beforeunload', function (e: BeforeUnloadEvent) {\n  if (master.saved) return null;\n  else {\n    const confirmationMessage =\n      'You have made unsaved changes. If you leave without saving these changes will be lost.';\n    e.returnValue = confirmationMessage;\n    return confirmationMessage;\n  }\n});\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { master } from './globals';\n\nexport const scrubberCanv = document.getElementById('scrubber') as HTMLCanvasElement;\nexport const scrubber = new createjs.Stage('scrubber');\nscrubber.enableMouseOver(10);\n\nexport interface ScrubberLine {\n  rectShape: createjs.Shape;\n  thumbShape: createjs.Shape;\n  rect: createjs.GraphicsCommand;\n  thumb: createjs.Shape & { rect: createjs.GraphicsCommand };\n  startMarker: createjs.Sprite;\n  endMarker: createjs.Sprite;\n}\n\nconst scrubberLineRectShape = new createjs.Shape();\nscrubberLineRectShape.graphics.setStrokeStyle(1).beginStroke('#d8d8d8');\nconst scrubberLineRect = scrubberLineRectShape.graphics\n  .drawRoundRect(0, (scrubberCanv.height - 10) / 2, scrubberCanv.width - 200, 10, 3, 3, 3, 3)\n  .command;\nscrubber.addChild(scrubberLineRectShape);\n\nconst thumb = new createjs.Shape() as createjs.Shape & { rect: createjs.GraphicsCommand };\nthumb.graphics.beginFill('#000');\nthumb.regX = 0;\nthumb.regY = 0;\nthumb.rect = thumb.graphics.drawRoundRect(-2, -5, 4, scrubberLineRect.h, 3, 3, 3, 3).command;\nscrubber.addChild(thumb);\n\nconst marker = new createjs.SpriteSheet({\n  images: ['icons/marker.png'],\n  frames: { width: 10, height: 9 },\n  animations: { default: 0 },\n});\n\nconst startMarkerSprite = new createjs.Sprite(marker, 'default');\nconst endMarkerSprite = new createjs.Sprite(marker, 'default');\nstartMarkerSprite.regX = 5;\nendMarkerSprite.regX = 5;\nscrubber.addChild(startMarkerSprite);\nscrubber.addChild(endMarkerSprite);\n\nexport const scrubberLine = {\n  rectShape: scrubberLineRectShape,\n  thumbShape: new createjs.Shape(),\n  rect: scrubberLineRect,\n  thumb: thumb,\n  startMarker: startMarkerSprite,\n  endMarker: endMarkerSprite,\n};\n\nconst buttons = new createjs.SpriteSheet({\n  images: ['icons/buttons.png'],\n  frames: { width: 20, height: 20 },\n  animations: {\n    frameBack: 0,\n    frameBackClicked: 1,\n    frameBackDisabled: 2,\n    frameForward: 3,\n    frameForwardClicked: 4,\n    frameForwardDisabled: 5,\n  },\n});\n\nexport interface FrameArrows {\n  forward: {\n    sprite: createjs.Sprite;\n    button: createjs.ButtonHelper;\n    enabled: boolean;\n  };\n  back: {\n    sprite: createjs.Sprite;\n    button: createjs.ButtonHelper;\n    enabled: boolean;\n  };\n  update(): void;\n}\n\nconst forwardSprite = new createjs.Sprite(buttons);\nconst backSprite = new createjs.Sprite(buttons);\n\nexport const frameArrows: FrameArrows = {\n  forward: {\n    sprite: forwardSprite,\n    button: new createjs.ButtonHelper(\n      forwardSprite, 'frameForward', 'frameForward', 'frameForwardClicked', false\n    ),\n    enabled: true,\n  },\n  back: {\n    sprite: backSprite,\n    button: new createjs.ButtonHelper(\n      backSprite, 'frameBack', 'frameBack', 'frameBackClicked', false\n    ),\n    enabled: true,\n  },\n  update() {\n    if (master.timeline.currentFrame === master.timeline.endFrame) {\n      frameArrows.forward.sprite.gotoAndStop('frameForwardDisabled');\n      frameArrows.forward.button.enabled = false;\n      frameArrows.forward.enabled = false;\n    } else {\n      frameArrows.forward.sprite.gotoAndStop('frameForward');\n      frameArrows.forward.button.enabled = true;\n      frameArrows.forward.enabled = true;\n    }\n\n    if (master.timeline.currentFrame === master.timeline.startFrame) {\n      frameArrows.back.sprite.gotoAndStop('frameBackDisabled');\n      frameArrows.back.button.enabled = false;\n      frameArrows.back.enabled = false;\n    } else {\n      frameArrows.back.sprite.gotoAndStop('frameBack');\n      frameArrows.back.button.enabled = true;\n      frameArrows.back.enabled = true;\n    }\n    scrubber.update();\n  },\n};\n\nscrubber.addChild(frameArrows.forward.sprite);\nscrubber.addChild(frameArrows.back.sprite);\nscrubber.update();\n\nexport function updateScrubber(time: number, total: number): void {\n  scrubberLine.thumb.x = (time / total) * scrubberLine.rect.w + scrubberLine.rect.x;\n  scrubberLine.startMarker.x =\n    master.timeline.startFrame * (scrubberLine.rect.w / master.timeline.frameCount) +\n    scrubberLine.rect.x;\n  scrubberLine.endMarker.x =\n    master.timeline.endFrame * (scrubberLine.rect.w / master.timeline.frameCount) +\n    scrubberLine.rect.x;\n  scrubber.update();\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport {\n  master, stage, background, background2, canvas, sidebar, videoContainer,\n  video, posText, posTextBackground, posTextBackgroundCommand,\n} from './globals';\nimport { scrubberCanv, scrubber, scrubberLine, frameArrows, updateScrubber } from './scrubber';\n\nexport function drawGraphics(_initialDraw = false): void {\n  if (window.innerWidth < 1000) {\n    if (!sidebar.classList.contains('changed')) {\n      sidebar.classList.remove('normal');\n      sidebar.classList.add('hidden');\n      const sidebarVis = document.getElementById('sidebar-visibility');\n      if (sidebarVis) {\n        sidebarVis.classList.add('show');\n        sidebarVis.classList.remove('hide');\n      }\n    }\n  } else {\n    if (!sidebar.classList.contains('changed')) {\n      sidebar.classList.add('normal');\n      sidebar.classList.remove('hidden');\n      const sidebarVis = document.getElementById('sidebar-visibility');\n      if (sidebarVis) {\n        sidebarVis.classList.add('hide');\n        sidebarVis.classList.remove('show');\n      }\n    }\n  }\n\n  const width = window.innerWidth - sidebar.offsetWidth;\n  const height = window.innerHeight - 50;\n\n  const sidebarVis = document.getElementById('sidebar-visibility');\n  if (sidebarVis) sidebarVis.style.right = sidebar.offsetWidth + 'px';\n\n  videoContainer.style.width = width + 'px';\n  videoContainer.style.height = height + 'px';\n\n  const scale = Math.min(\n    width / master.timeline.video.videoWidth,\n    height / master.timeline.video.videoHeight\n  );\n\n  canvas.height = height;\n  canvas.width = width;\n\n  if (master.positioning.autoZoom) {\n    master.backgroundScale = scale;\n    background.scale = master.backgroundScale * master.positioning.zoom;\n  }\n\n  const bg = master.background as createjs.Bitmap & { w: number; h: number };\n  bg.w = background.scale * master.timeline.video.videoWidth;\n  bg.h = background.scale * master.timeline.video.videoHeight;\n\n  if (bg.w <= canvas.width) {\n    master.positioning.x = (canvas.width - background.scale * master.timeline.video.videoWidth) / 2;\n  } else {\n    if (master.positioning.x + bg.w < canvas.width) {\n      master.positioning.x = canvas.width - bg.w;\n    }\n    if (master.positioning.x > 0 && bg.w > canvas.width) {\n      master.positioning.x = 0;\n    }\n  }\n  if (bg.h <= canvas.height) {\n    master.positioning.y = (canvas.height - background.scale * master.timeline.video.videoHeight) / 2;\n  } else {\n    if (master.positioning.y + bg.h < canvas.height) {\n      master.positioning.y = canvas.height - bg.h;\n    }\n    if (master.positioning.y > 0 && bg.h > canvas.height) {\n      master.positioning.y = 0;\n    }\n  }\n\n  background2.scale = background.scale;\n  background2.x = background.x;\n  background2.y = background.y;\n\n  scrubberCanv.width = canvas.width;\n  scrubberCanv.height = 50;\n  scrubberLine.rect.w = scrubberCanv.width / stage.scaleX - 100;\n  scrubberLine.rect.h = 10;\n  scrubberLine.rect.y = (scrubberCanv.height - 10) / 2;\n  scrubberLine.rect.x = 15;\n\n  scrubberLine.thumb.y = scrubberLine.rect.y;\n  scrubberLine.thumb.x = scrubberLine.rect.x;\n  scrubberLine.thumb.rect.h = scrubberLine.rect.h + 10;\n\n  frameArrows.forward.sprite.x = scrubberCanv.width - 30;\n  frameArrows.forward.sprite.y = (scrubberCanv.height - 20) / 2;\n\n  frameArrows.back.sprite.x = scrubberCanv.width - 60;\n  frameArrows.back.sprite.y = (scrubberCanv.height - 20) / 2;\n\n  posText.x = 10;\n  posText.regY = 20;\n  posText.y = stage.globalToLocal(0, canvas.height).y;\n\n  posTextBackground.regY = posTextBackgroundCommand.h;\n  posTextBackground.y = stage.globalToLocal(0, canvas.height).y;\n\n  scrubberLine.startMarker.x =\n    (master.timeline.startFrame / master.timeline.frameCount) * scrubberLine.rect.w +\n    scrubberLine.rect.x;\n  scrubberLine.endMarker.x =\n    (master.timeline.endFrame / master.timeline.frameCount) * scrubberLine.rect.w +\n    scrubberLine.rect.x;\n  scrubberLine.startMarker.y = scrubberLine.rect.y + scrubberLine.rect.h + 6;\n  scrubberLine.endMarker.y = scrubberLine.rect.y + scrubberLine.rect.h + 6;\n\n  master.handsOnTable.render();\n\n  updateScrubber(master.timeline.currentTime, master.timeline.duration);\n  stage.update();\n  master.updateScale();\n  scrubber.update();\n  frameArrows.update();\n}\n\nvideo.addEventListener('playing', function () {\n  video.pause();\n  video.currentTime = 0;\n  background.image = video;\n  master.updateVisiblePoints();\n  drawGraphics(true);\n  video.style.display = 'none';\n});\n\nstage.on('stagemousemove', function (e: createjs.MouseEvent) {\n  const coords = e.target.stage.globalToLocal(e.stageX, e.stageY);\n\n  if (master.state.mode !== 'newScale') {\n    posText.text =\n      'Frame: ' +\n      master.timeline.currentFrame +\n      ', X: ' +\n      Math.round(coords.x) +\n      ', Y: ' +\n      Math.round(coords.y);\n  }\n\n  stage.update();\n});\n\nstage.on('click', function (e: createjs.MouseEvent) {\n  if (master.track !== null && master.track !== undefined) {\n    if (master.track.state.mode === 'add') {\n      const frame = master.timeline.current();\n      if (frame === false) return;\n      const scaled = master.toScaled(e.stageX, e.stageY);\n      master.track.addPoint(frame, scaled.x, scaled.y);\n\n      const nextFrame = master.timeline.next();\n      if (nextFrame === false) return;\n      master.timeline.setFrame(nextFrame.number);\n\n      if (master.track.points[nextFrame.number] !== undefined)\n        master.track.points[nextFrame.number].show().emphasize();\n    }\n  }\n});\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport './functions';\nimport { master } from './globals';\nimport { scrubberLine, frameArrows } from './scrubber';\n\nframeArrows.forward.sprite.on('click', function () {\n  if (frameArrows.forward.enabled === true) {\n    const frame = master.timeline.next();\n\n    if (frame !== false && frame.number <= master.timeline.endFrame) {\n      if (master.timeline.setFrame(frame.number) !== false) {\n        if (master.track !== null) {\n          master.track.unselectAll();\n          master.track.unemphasizeAll();\n          if (master.track.points[frame.number] !== undefined) {\n            master.track.points[frame.number].show().emphasize();\n          }\n        }\n      }\n    }\n  }\n});\n\nframeArrows.back.sprite.on('click', function () {\n  if (frameArrows.back.enabled === true) {\n    const frame = master.timeline.prev();\n\n    if (frame !== false && frame.number >= master.timeline.startFrame) {\n      if (master.timeline.setFrame(frame.number) !== false) {\n        if (master.track !== null) {\n          master.track.unselectAll();\n          master.track.unemphasizeAll();\n          if (master.track.points[frame.number] !== undefined) {\n            master.track.points[frame.number].show().emphasize();\n          }\n        }\n      }\n    }\n  }\n});\n\nscrubberLine.thumb.on('pressmove', function (e: createjs.MouseEvent) {\n  const coords = e.target.stage.globalToLocal(e.stageX, e.stageY);\n\n  if (\n    coords.x >= scrubberLine.rect.x &&\n    coords.x <= scrubberLine.rect.w + scrubberLine.rect.x\n  ) {\n    const closestFrame = Math.round(\n      (((coords.x - scrubberLine.rect.x) / scrubberLine.rect.w) * master.timeline.duration) /\n        master.timeline.frameTime\n    );\n    if (\n      closestFrame <= master.timeline.endFrame &&\n      closestFrame >= master.timeline.startFrame\n    ) {\n      scrubberLine.thumb.x =\n        closestFrame * (scrubberLine.rect.w / master.timeline.frameCount) +\n        scrubberLine.rect.x;\n      master.timeline.seek(closestFrame);\n    } else if (closestFrame < master.timeline.startFrame) {\n      master.timeline.seek(master.timeline.startFrame);\n    } else if (closestFrame > master.timeline.endFrame) {\n      master.timeline.seek(master.timeline.endFrame);\n    }\n  } else if (\n    coords.x <\n    (scrubberLine.rect.w / master.timeline.frameCount) * master.timeline.startFrame +\n      scrubberLine.rect.x\n  ) {\n    master.timeline.seek(master.timeline.startFrame);\n  } else if (\n    coords.x >\n    (scrubberLine.rect.w / master.timeline.frameCount) * master.timeline.endFrame +\n      scrubberLine.rect.x\n  ) {\n    master.timeline.seek(master.timeline.endFrame);\n  }\n});\n\nlet startMarkerStuck = false;\nconst startFrames: number[] = [];\n\nscrubberLine.startMarker.on('mousedown', function () {\n  if (startFrames.length === 0) {\n    startFrames.push(master.timeline.startFrame);\n  }\n});\nscrubberLine.startMarker.on('pressmove', function (e: createjs.MouseEvent) {\n  const coords = e.target.stage.globalToLocal(e.stageX, e.stageY);\n  const closestFrame = master.timeline.getClosestFrame(\n    ((coords.x - scrubberLine.rect.x) / scrubberLine.rect.w) * master.timeline.duration\n  );\n  if (\n    closestFrame <= master.timeline.frameCount &&\n    closestFrame < master.timeline.endFrame &&\n    closestFrame >= 0\n  ) {\n    scrubberLine.startMarker.x =\n      closestFrame * (scrubberLine.rect.w / master.timeline.frameCount) +\n      scrubberLine.rect.x;\n    master.timeline.startFrame = closestFrame;\n    if (master.timeline.currentFrame <= master.timeline.startFrame) {\n      startMarkerStuck = true;\n    }\n    master.update();\n  } else if (closestFrame < 0) {\n    scrubberLine.startMarker.x = scrubberLine.rect.x;\n    master.timeline.startFrame = 0;\n    if (master.timeline.currentFrame <= master.timeline.startFrame) {\n      startMarkerStuck = true;\n    }\n    master.update();\n  }\n\n  if (startMarkerStuck) {\n    master.timeline.seek(master.timeline.startFrame);\n  }\n\n  frameArrows.update();\n});\nscrubberLine.startMarker.on('pressup', function () {\n  const lastVal = startFrames[startFrames.length - 1];\n  if (master.timeline.startFrame !== lastVal) {\n    const last = lastVal;\n    const current = master.timeline.startFrame;\n    const stuck = startMarkerStuck;\n    const index = startFrames.length;\n    if (startFrames.length >= 1) {\n      master.change({\n        undo: function () {\n          startFrames.splice(index, 1);\n          scrubberLine.startMarker.x =\n            last * (scrubberLine.rect.w / master.timeline.frameCount) +\n            scrubberLine.rect.x;\n          master.timeline.startFrame = last;\n          if (stuck) {\n            master.timeline.seek(master.timeline.startFrame);\n          }\n          master.update();\n        },\n        redo: function () {\n          startFrames.push(current);\n          scrubberLine.startMarker.x =\n            current * (scrubberLine.rect.w / master.timeline.frameCount) +\n            scrubberLine.rect.x;\n          master.timeline.startFrame = current;\n          if (stuck) {\n            master.timeline.seek(master.timeline.startFrame);\n          }\n          master.update();\n        },\n      });\n    }\n  }\n\n  startFrames.push(master.timeline.startFrame);\n  startMarkerStuck = false;\n});\n\nlet endMarkerStuck = false;\nconst endFrames: number[] = [];\n\nscrubberLine.endMarker.on('mousedown', function () {\n  if (endFrames.length === 0) {\n    endFrames.push(master.timeline.endFrame);\n  }\n});\nscrubberLine.endMarker.on('pressmove', function (e: createjs.MouseEvent) {\n  const coords = e.target.stage.globalToLocal(e.stageX, e.stageY);\n  const closestFrame = master.timeline.getClosestFrame(\n    ((coords.x - scrubberLine.rect.x) / scrubberLine.rect.w) * master.timeline.duration\n  );\n  if (\n    closestFrame <= master.timeline.frameCount &&\n    closestFrame > master.timeline.startFrame\n  ) {\n    scrubberLine.endMarker.x =\n      closestFrame * (scrubberLine.rect.w / master.timeline.frameCount) +\n      scrubberLine.rect.x;\n    master.timeline.endFrame = closestFrame;\n    if (master.timeline.currentFrame > master.timeline.endFrame) {\n      endMarkerStuck = true;\n    }\n    master.update();\n  } else if (closestFrame > master.timeline.frameCount) {\n    scrubberLine.endMarker.x =\n      master.timeline.frameCount *\n        (scrubberLine.rect.w / master.timeline.frameCount) +\n      scrubberLine.rect.x;\n    master.timeline.endFrame = master.timeline.frameCount;\n    if (master.timeline.currentFrame >= master.timeline.endFrame) {\n      endMarkerStuck = true;\n    }\n    master.update();\n  }\n\n  if (endMarkerStuck) {\n    master.timeline.seek(master.timeline.endFrame);\n  }\n  frameArrows.update();\n});\n\nscrubberLine.endMarker.on('pressup', function () {\n  const lastVal = endFrames[endFrames.length - 1];\n  if (master.timeline.endFrame !== lastVal) {\n    const last = lastVal;\n    const current = master.timeline.endFrame;\n    const stuck = endMarkerStuck;\n    const index = endFrames.length;\n    if (endFrames.length >= 1) {\n      master.change({\n        undo: function () {\n          endFrames.splice(index, 1);\n          scrubberLine.endMarker.x =\n            last * (scrubberLine.rect.w / master.timeline.frameCount) +\n            scrubberLine.rect.x;\n          master.timeline.endFrame = last;\n          if (stuck) {\n            master.timeline.seek(master.timeline.endFrame);\n          }\n          master.update();\n        },\n        redo: function () {\n          endFrames.push(current);\n          scrubberLine.endMarker.x =\n            current * (scrubberLine.rect.w / master.timeline.frameCount) +\n            scrubberLine.rect.x;\n          master.timeline.endFrame = current;\n          if (stuck) {\n            master.timeline.seek(master.timeline.endFrame);\n          }\n          master.update();\n        },\n      });\n    }\n  }\n\n  endFrames.push(master.timeline.endFrame);\n  endMarkerStuck = false;\n});\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { master, canvas, background2 } from './globals';\n\nlet originalCoords = { x: 0, y: 0 };\nlet originalPosition = { x: master.positioning.x, y: master.positioning.y };\nlet backgroundDimensions = {\n  w: (master.background as createjs.Bitmap & { w: number }).w,\n  h: (master.background as createjs.Bitmap & { h: number }).h,\n};\n\nmaster.addBackground.on('mousedown', function (e: createjs.MouseEvent) {\n  originalCoords = { x: e.stageX, y: e.stageY };\n  originalPosition = { x: master.positioning.x, y: master.positioning.y };\n  backgroundDimensions = {\n    w: (master.background as createjs.Bitmap & { w: number }).w,\n    h: (master.background as createjs.Bitmap & { h: number }).h,\n  };\n});\nmaster.addBackground.on('pressmove', function (e: createjs.MouseEvent) {\n  const coords = e.target.stage.globalToLocal(e.stageX, e.stageY);\n  if (master.state.mode === 'positioning') {\n    const newPos = {\n      x: originalPosition.x + coords.x - originalCoords.x,\n      y: originalPosition.y + coords.y - originalCoords.y,\n    };\n\n    if (newPos.x + backgroundDimensions.w < canvas.width) {\n      newPos.x = canvas.width - backgroundDimensions.w;\n    }\n    if (newPos.x > 0 && backgroundDimensions.w > canvas.width) {\n      newPos.x = 0;\n    }\n    if (newPos.y + backgroundDimensions.h < canvas.height) {\n      newPos.y = canvas.height - backgroundDimensions.h;\n    }\n    if (newPos.y > 0 && backgroundDimensions.h > canvas.height) {\n      newPos.y = 0;\n    }\n\n    if (backgroundDimensions.w > canvas.width) {\n      master.positioning.x = newPos.x;\n      master.positioning.stuck = false;\n    }\n    if (backgroundDimensions.h > canvas.height) {\n      master.positioning.y = newPos.y;\n      master.positioning.stuck = false;\n    }\n  }\n});\n\ncanvas.addEventListener('wheel', function (e: WheelEvent) {\n  e.preventDefault();\n  if (master.state.mode === 'positioning') {\n    if (master.positioning.zoom > 0.01 || Math.sign(e.deltaY) === -1)\n      master.positioning.zoom -= e.deltaY / 25;\n\n    if (master.positioning.zoom <= 0.01) master.positioning.zoom = 0.01;\n  }\n});\n\nmaster.positioning\n  .on('zoomin, zoomout', function (this: typeof master, e) {\n    const bg = this.background as createjs.Bitmap & { w: number; h: number };\n    const newPos = { x: master.positioning.x, y: master.positioning.y };\n\n    newPos.x -= (this.timeline.video.videoWidth * (e.delta || 0)) / 2;\n    newPos.y -= (this.timeline.video.videoHeight * (e.delta || 0)) / 2;\n\n    if (bg.w > this.stage.canvas.width) {\n      if (newPos.x + bg.w < this.stage.canvas.width)\n        this.positioning.x = canvas.width - bg.w;\n      else if (newPos.x > 0) this.positioning.x = 0;\n      else this.positioning.x = newPos.x;\n    } else {\n      this.positioning.x = (this.stage.canvas.width - bg.w) / 2;\n    }\n\n    if (bg.h > this.stage.canvas.height) {\n      if (newPos.y + bg.h < this.stage.canvas.height)\n        this.positioning.y = canvas.height - bg.h;\n      else if (newPos.y > 0) this.positioning.y = 0;\n      else this.positioning.y = newPos.y;\n    } else {\n      this.positioning.y = (this.stage.canvas.height - bg.h) / 2;\n    }\n  })\n  .on('zoom, translation', function (this: typeof master) {\n    const bg = this.background as createjs.Bitmap & { x: number; y: number; scale: number };\n    background2.scale = bg.scale;\n    background2.x = bg.x;\n    background2.y = bg.y;\n  })\n  .on('zoom', function () {\n    const el = document.getElementById('screen-fit-button');\n    if (el) el.classList.remove('disabled');\n  });\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { master, stage } from './globals';\nimport { scrubberLine, frameArrows, updateScrubber } from './scrubber';\n\nconst posText = (stage.children.find(\n  (c) => c instanceof createjs.Text\n) as createjs.Text) || new createjs.Text('', '', '');\n\nmaster.on('deleteTrack', function () {\n  if (Object.keys(master.trackList).length === 0) {\n    const el = document.getElementById('tracks');\n    if (el) el.classList.add('hidden');\n  }\n});\n\nmaster.on('undeleteTrack', function () {\n  if (Object.keys(master.trackList).length > 0) {\n    const el = document.getElementById('tracks');\n    if (el) el.classList.remove('hidden');\n  }\n});\n\nmaster.on('newScale', function () {\n  const el = document.getElementById('scale-button');\n  if (el) el.title = 'Edit Scale';\n});\n\nmaster.on('newTrack', function () {\n  const tracks = document.getElementById('tracks');\n  if (tracks) tracks.classList.remove('hidden');\n  const exportBtn = document.getElementById('export-button');\n  if (exportBtn) exportBtn.classList.remove('disabled');\n});\n\nmaster.on('newpoint', function () {\n  const el = document.getElementById('graphs');\n  if (el) el.classList.remove('hidden');\n});\n\nmaster.on('created', function (this: typeof master) {\n  scrubberLine.startMarker.x =\n    this.timeline.startFrame * (scrubberLine.rect.w / this.timeline.frameCount) +\n    scrubberLine.rect.x;\n  scrubberLine.endMarker.x =\n    this.timeline.endFrame * (scrubberLine.rect.w / this.timeline.frameCount) +\n    scrubberLine.rect.x;\n\n  updateScrubber(master.timeline.currentTime, master.timeline.duration);\n  this.updateVisiblePoints();\n  frameArrows.update();\n});\n\nlet secondVidTimeout: ReturnType<typeof setTimeout> | null = null;\nmaster.timeline.on('seek, timingUpdate', function (this: typeof master.timeline) {\n  this.project.updateVisiblePoints();\n  frameArrows.update();\n  posText.text =\n    'Frame: ' +\n    master.timeline.currentFrame +\n    ', X: ' +\n    stage.mouseX +\n    ', Y: ' +\n    stage.mouseY;\n  if (this.project.track !== null && this.project.track !== undefined) {\n    this.project.track.unemphasizeAll();\n    if (this.project.track.points[this.project.timeline.currentFrame] !== undefined) {\n      this.project.track.points[this.project.timeline.currentFrame].emphasize();\n    }\n  }\n  updateScrubber(master.timeline.currentTime, master.timeline.duration);\n  const video2 = document.getElementById('video-clone') as HTMLVideoElement;\n  if (secondVidTimeout !== null) clearTimeout(secondVidTimeout);\n  secondVidTimeout = setTimeout(function () {\n    video2.currentTime = master.timeline.currentTime;\n  }, 100);\n});\n\nmaster.timeline.on('play', function () {\n  const el = document.getElementById('video-clone') as HTMLVideoElement | null;\n  if (el) el.style.opacity = '0';\n});\n\nmaster.timeline.on('pause', function () {\n  const el = document.getElementById('video-clone') as HTMLVideoElement | null;\n  if (el) el.style.opacity = '1';\n});\n","/**\n * Based on Google Drive File Picker Example\n * By Daniel Lo Nigro (http://dan.cx/)\n */\n\ninterface DriveUploadOptions {\n  apiKey: string;\n  clientId: string;\n  buttonEl: HTMLButtonElement;\n  logoutEl: HTMLElement;\n  getFile: (callback: (file: ArrayBuffer, name: string, done: (success: boolean) => void) => void) => void;\n}\n\nexport class DriveUpload {\n  apiKey: string;\n  clientId: string;\n  buttonEl: HTMLButtonElement;\n  logoutEl: HTMLElement;\n  private _getFile: DriveUploadOptions['getFile'];\n\n  constructor(options: DriveUploadOptions) {\n    this.apiKey = options.apiKey;\n    this.clientId = options.clientId;\n    this.buttonEl = options.buttonEl;\n    this.logoutEl = options.logoutEl;\n    this._getFile = options.getFile;\n    this.buttonEl.addEventListener('click', this.open.bind(this));\n    this.logoutEl.addEventListener(\n      'click',\n      function (this: HTMLElement) {\n        if (!this.classList.contains('disabled')) {\n          gapi.auth.signOut();\n          this.classList.add('disabled');\n        }\n      }.bind(this.logoutEl)\n    );\n\n    this.buttonEl.disabled = true;\n\n    gapi.client.setApiKey(this.apiKey);\n    gapi.client.load('drive', 'v2', this._driveApiLoaded.bind(this));\n  }\n\n  open(): void {\n    const token = gapi.auth.getToken();\n    if (token && !this.logoutEl.classList.contains('disabled')) {\n      this._upload();\n      this.logoutEl.classList.remove('disabled');\n    } else {\n      this._doAuth(false, () => {\n        this._upload();\n        this.logoutEl.classList.remove('disabled');\n      });\n    }\n  }\n\n  private _upload(): void {\n    this._getFile(function (file: ArrayBuffer, name: string, callback: (success: boolean) => void) {\n      const metadata = { name: name };\n      gapi.client\n        .request({\n          path: '/upload/drive/v3/files',\n          method: 'POST',\n          params: { uploadType: 'resumable' },\n          headers: {\n            'X-Upload-Content-Type': 'application/x-zip',\n            'X-Upload-Content-Length': String(file.byteLength),\n            'Content-Type': 'application/json; charset=UTF-8',\n            'Content-Length': String(JSON.stringify(metadata).utf8Length()),\n          },\n          body: metadata,\n        })\n        .then(function (response: { headers: { location: string } }) {\n          const resumableURI = response.headers.location;\n          const uploadFileRequest = new XMLHttpRequest();\n          uploadFileRequest.open('PUT', resumableURI, true);\n          const token = gapi.auth.getToken();\n          if (token) {\n            uploadFileRequest.setRequestHeader(\n              'Authorization',\n              'Bearer ' + token.access_token\n            );\n          }\n          uploadFileRequest.setRequestHeader('Content-Type', 'application/x-zip');\n          uploadFileRequest.setRequestHeader(\n            'X-Upload-Content-Type',\n            'application/x-zip'\n          );\n          uploadFileRequest.onreadystatechange = function () {\n            if (uploadFileRequest.readyState === XMLHttpRequest.DONE) callback(true);\n            else callback(false);\n          };\n          uploadFileRequest.send(file);\n        });\n    });\n  }\n\n  private _driveApiLoaded(): void {\n    this.buttonEl.disabled = false;\n    this._doAuth(true);\n  }\n\n  private _doAuth(immediate: boolean, callback?: () => void): void {\n    if (this.logoutEl.classList.contains('disabled')) {\n      gapi.auth.authorize(\n        {\n          client_id: this.clientId + '.apps.googleusercontent.com',\n          scope: 'https://www.googleapis.com/auth/drive',\n          immediate: immediate,\n          authuser: -1,\n        },\n        callback\n      );\n    } else {\n      gapi.auth.authorize(\n        {\n          client_id: this.clientId + '.apps.googleusercontent.com',\n          scope: 'https://www.googleapis.com/auth/drive',\n          immediate: immediate,\n        },\n        callback\n      );\n    }\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport {\n  master, canvas, stage, CUSTOM_EXTENSION, GOOGLE_API_KEY, GOOGLE_CLIENT_ID,\n  EXPORT_FORMATS, newProject, saveProject, editProject, exportData,\n  newScale, editScale, newTrack, editTrack,\n} from './globals';\nimport { showLoader, hideLoader } from './functions';\nimport { DriveUpload } from './saveDrive';\n\nnewProject.on('submit', function (data) {\n  if (!data) return;\n  master.name = data.name;\n  master.videoSpeed = parseFloat(data.videospeed);\n  master.timeline.frameSkip = parseInt(data.frameskip);\n  master.timeline.updateTiming(master.timeline.video.duration, data.framerate);\n  master.timeline.createFrames();\n  const axesPos = master.toScaled(canvas.width / 2, canvas.height / 2);\n  master.newAxes(axesPos.x, axesPos.y, data.axesColor, true);\n  this.hide().clear();\n  master.viewPoints = {\n    forward: parseInt(data.pointsForward),\n    backward: parseInt(data.pointsBackward),\n  };\n  master.updateVisiblePoints();\n  master.created = true;\n  master.trigger('created');\n\n  gtag('event', 'New Project', {\n    event_category: 'Start',\n    event_label: master.name,\n  });\n});\n\nsaveProject\n  .on('saveFile', function (modalData) {\n    if (!modalData) return;\n    showLoader();\n    const fileUrl = URL.createObjectURL(master.videoFile!);\n    JSZipUtils.getBinaryContent(fileUrl, function (err: Error | null, data: ArrayBuffer) {\n      if (err) {\n        console.log(err);\n      }\n\n      let filename = modalData.filename || '';\n\n      if (filename.length === 0) {\n        filename =\n          master.name.toLowerCase().replace(' ', '_') +\n          '-' +\n          new Date().getTime() +\n          '.' +\n          CUSTOM_EXTENSION;\n      } else if (filename.split('.').pop() !== CUSTOM_EXTENSION)\n        filename += '.' + CUSTOM_EXTENSION;\n\n      const projectInfo = JSON.stringify(master.save());\n      const zip = new JSZip();\n\n      zip.file('video.mp4', data, { binary: true }).file('meta.json', projectInfo);\n\n      zip\n        .generateAsync({ type: 'blob', mimeType: 'application/octet-stream' })\n        .then(\n          function (blob: Blob) {\n            saveAs(blob, filename);\n            master.saved = true;\n            hideLoader();\n          },\n          function (err: Error) {\n            console.log(err);\n          }\n        );\n    });\n\n    this.hide().clear();\n  })\n  .on('create', function (this: typeof saveProject) {\n    const button = document.getElementById(\n      this.id + '_button-saveDrive'\n    ) as HTMLButtonElement | null;\n    if (button) button.disabled = true;\n    const modalRef = this;\n    const checkLoaded = setInterval(function () {\n      try {\n        if (typeof gapi !== 'undefined') {\n          if (gapi.client !== undefined) {\n            const logoutEl = document.getElementById('logout-button');\n            const saveDriveBtn = document.getElementById(\n              modalRef.id + '_button-saveDrive'\n            ) as HTMLButtonElement | null;\n            if (saveDriveBtn && logoutEl) {\n              new DriveUpload({\n                apiKey: GOOGLE_API_KEY,\n                clientId: GOOGLE_CLIENT_ID,\n                buttonEl: saveDriveBtn,\n                logoutEl: logoutEl,\n                getFile: function (callback) {\n                  showLoader();\n                  const fileUrl = URL.createObjectURL(master.videoFile!);\n                  JSZipUtils.getBinaryContent(\n                    fileUrl,\n                    function (err: Error | null, data: ArrayBuffer) {\n                      if (err) {\n                        console.log(err);\n                      }\n\n                      const exported = modalRef.export();\n                      let filename = (exported && exported.filename) || '';\n                      if (filename.length === 0) {\n                        filename =\n                          master.name.toLowerCase().replace(' ', '_') +\n                          '-' +\n                          new Date().getTime() +\n                          '.' +\n                          CUSTOM_EXTENSION;\n                      } else if (filename.split('.').pop() !== CUSTOM_EXTENSION)\n                        filename += '.' + CUSTOM_EXTENSION;\n\n                      const projectInfo = JSON.stringify(master.save());\n                      const zip = new JSZip();\n\n                      zip\n                        .file('video.mp4', data, { binary: true })\n                        .file('meta.json', projectInfo);\n\n                      zip\n                        .generateAsync({\n                          type: 'blob',\n                          mimeType: 'application/octet-stream',\n                        })\n                        .then(\n                          function (zipFile: Blob) {\n                            const reader = new FileReader();\n                            reader.onload = function () {\n                              callback(\n                                reader.result as unknown as ArrayBuffer,\n                                filename,\n                                function (success: boolean) {\n                                  hideLoader();\n                                  modalRef.hide();\n                                }\n                              );\n                            };\n                            reader.readAsArrayBuffer(zipFile);\n                          },\n                          function (err: Error) {\n                            console.log(err);\n                          }\n                        );\n                    }\n                  );\n                },\n              });\n            }\n            clearInterval(checkLoaded);\n          }\n        }\n      } catch {\n        console.log('Google could not be loaded.');\n        clearInterval(checkLoaded);\n      }\n    }, 400);\n  })\n  .on('cancel', function () {\n    this.hide().clear();\n  });\n\neditProject\n  .on('submit', function (data) {\n    if (!data) return;\n    master.name = data.name;\n    master.timeline.frameSkip = parseInt(data.frameskip);\n    master.axes?.updateColor(data.axesColor);\n    this.hide().clear();\n    master.viewPoints = {\n      forward: parseInt(data.pointsForward),\n      backward: parseInt(data.pointsBackward),\n    };\n    master.updateVisiblePoints();\n  })\n  .on('cancel', function () {\n    this.hide().clear();\n  });\n\nexportData\n  .on('submit', function (data) {\n    if (!data) return;\n    const workbook = XLSX.utils.book_new();\n\n    for (const uid in master.trackList) {\n      const track = master.trackList[uid];\n      const ws = XLSX.utils.aoa_to_sheet(track.export().table.scaled);\n      XLSX.utils.book_append_sheet(workbook, ws, track.name);\n    }\n\n    let filename = data.filename;\n\n    if (filename.split('.').length <= 1) filename += '.xlsx';\n\n    if (!EXPORT_FORMATS.includes(filename.split('.')[filename.split('.').length - 1]))\n      filename += '.xlsx';\n\n    XLSX.writeFile(workbook, filename);\n\n    this.hide().clear();\n  })\n  .on('cancel', function () {\n    this.hide().clear();\n  });\n\neditScale\n  .on('cancel', function () {\n    this.hide().clear();\n  })\n  .on('submit', function (data) {\n    if (!data) return;\n    master.scale?.updateInfo({ color: data.color });\n    this.hide();\n  });\n\nlet scaleClickCounter = 3;\nnewScale\n  .on('submit', function (data) {\n    if (!data) return;\n    master.state.mode = 'newScale';\n    scaleClickCounter = 1;\n    const locations = {\n      point1: { x: 0, y: 0 },\n      point2: { x: 0, y: 0 },\n    };\n    const posTextEl = stage.children.find(\n      (c) => c instanceof createjs.Text\n    ) as createjs.Text | undefined;\n    if (posTextEl) posTextEl.text = 'Click for 1st end of scale';\n    stage.on('click', function (e: createjs.MouseEvent) {\n      const mouseCoords = master.toScaled(e.stageX, e.stageY);\n      if (scaleClickCounter === 1) {\n        locations.point1 = { x: mouseCoords.x, y: mouseCoords.y };\n        if (posTextEl) posTextEl.text = 'Click for 2nd end of scale';\n        scaleClickCounter++;\n      } else if (scaleClickCounter === 2) {\n        locations.point2 = { x: mouseCoords.x, y: mouseCoords.y };\n        const scale = master.newScale(\n          null,\n          locations.point1.x,\n          locations.point1.y,\n          locations.point2.x,\n          locations.point2.y,\n          data.color\n        );\n        window.setTimeout(function () {\n          scale.textElement.dispatchEvent(new Event('startEditing'));\n          scale.textElement.value = '';\n          scale.textElement.focus();\n        }, 200);\n        stage.cursor = 'default';\n        master.state.default();\n        scaleClickCounter++;\n      }\n    });\n    this.hide().clear();\n  })\n  .on('cancel', function () {\n    this.hide().clear();\n  });\n\neditTrack\n  .on('cancel', function () {\n    this.hide().clear();\n  })\n  .on('submit', function (data) {\n    if (!data) return;\n    if (master.trackList[data.uid] !== undefined) {\n      master.trackList[data.uid].update({\n        name: data.name,\n        color: data.color,\n      });\n    }\n    this.hide();\n  });\n\nnewTrack\n  .on('cancel', function () {\n    this.hide().clear();\n  })\n  .on('submit', function (data) {\n    if (!data) return;\n    this.hide().clear();\n    master.newTrack(data.name, data.color, true);\n  });\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { master, canvas, saveProject } from './globals';\nimport { drawGraphics } from './index';\n\nkeyboardJS.pause();\nkeyboardJS.on(\n  'shift',\n  function (e: KeyboardJSEvent) {\n    e.preventRepeat();\n    if (master.track !== null && master.track !== undefined) {\n      master.state.mode = 'add';\n      for (const uid in master.trackList) {\n        master.trackList[uid].state.mode = 'add';\n      }\n    }\n  },\n  function () {\n    if (master.track !== null && master.track !== undefined) {\n      master.state.reset();\n      for (const uid in master.trackList) {\n        master.trackList[uid].state.resetMode();\n      }\n    }\n  }\n);\n\nkeyboardJS.on(\n  's',\n  function (e: KeyboardJSEvent) {\n    e.preventRepeat();\n    master.state.mode = 'seek';\n  },\n  function () {\n    master.state.reset();\n  }\n);\n\nkeyboardJS.on(['delete', 'backspace'], function () {\n  if (master.track !== undefined && master.track !== null) {\n    if (master.track.selectedPoint !== null && master.track.selectedPoint !== undefined) {\n      master.track.selectedPoint.shape.dispatchEvent(new Event('dblclick'));\n    }\n  }\n});\n\nkeyboardJS.on(['up', 'down', 'right', 'left'], function (e: KeyboardJSEvent) {\n  const bg = master.background as createjs.Bitmap & { w: number; h: number };\n  const newPos = { x: master.positioning.x, y: master.positioning.y };\n\n  switch (e.key) {\n    case 'ArrowLeft':\n      newPos.x += 20;\n      break;\n    case 'ArrowRight':\n      newPos.x -= 20;\n      break;\n    case 'ArrowUp':\n      newPos.y += 20;\n      break;\n    case 'ArrowDown':\n      newPos.y -= 20;\n      break;\n  }\n\n  if (newPos.x + bg.w < canvas.width) {\n    newPos.x = canvas.width - bg.w;\n  }\n  if (newPos.x > 0 && bg.w > canvas.width) {\n    newPos.x = 0;\n  }\n  if (newPos.y + bg.h < canvas.height) {\n    newPos.y = canvas.height - bg.h;\n  }\n  if (newPos.y > 0 && bg.h > canvas.height) {\n    newPos.y = 0;\n  }\n\n  if (bg.w > canvas.width) {\n    master.positioning.x = newPos.x;\n    master.positioning.stuck = false;\n  }\n  if (bg.h > canvas.height) {\n    master.positioning.y = newPos.y;\n    master.positioning.stuck = false;\n  }\n});\n\nkeyboardJS.on(['ctrl + =', 'ctrl + +', 'cmd + =', 'cmd + +'], function (e: KeyboardJSEvent) {\n  e.preventDefault();\n  master.positioning.zoom += 0.01;\n});\n\nkeyboardJS.on(['ctrl + -', 'cmd + -'], function (e: KeyboardJSEvent) {\n  e.preventDefault();\n  if (master.positioning.zoom > 0.02) master.positioning.zoom -= 0.01;\n  else master.positioning.zoom = 0.01;\n});\n\nkeyboardJS.on(['=', '+'], function () {\n  master.positioning.zoom += 0.05;\n});\n\nkeyboardJS.on('-', function () {\n  if (master.positioning.zoom > 0.1) master.positioning.zoom -= 0.05;\n  else master.positioning.zoom = 0.05;\n});\n\nkeyboardJS.on(['ctrl + 0', 'cmd + 0'], function (e: KeyboardJSEvent) {\n  e.preventDefault();\n  master.positioning.zoom = 1;\n  master.positioning.autoZoom = true;\n  master.positioning.stuck = true;\n  drawGraphics();\n  const el = document.getElementById('screen-fit-button');\n  if (el) el.classList.add('disabled');\n});\n\nkeyboardJS.on(\n  'ctrl',\n  function (e: KeyboardJSEvent) {\n    e.preventRepeat();\n    master.state.mode = 'positioning';\n  },\n  function () {\n    master.state.reset();\n  }\n);\n\nkeyboardJS.on(['ctrl+z', 'cmd+z'], function () {\n  master.undo();\n});\n\nkeyboardJS.on(['ctrl+y', 'cmd+y'], function () {\n  master.redo();\n});\n\nkeyboardJS.on(['ctrl+s', 'cmd+s'], function (e: KeyboardJSEvent) {\n  e.preventRepeat();\n  e.preventDefault();\n  saveProject.show();\n});\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport {\n  master, newTrack, saveProject, editProject, editScale, newScale, exportData, editTrack,\n} from './globals';\nimport { drawGraphics } from './index';\n\ndocument.getElementById('new-project')?.addEventListener('click', function () {\n  window.location.reload();\n});\n\ndocument.getElementById('sidebar-visibility')?.addEventListener('click', function (this: HTMLElement) {\n  const sidebarEl = document.getElementById('sidebar');\n  const visEl = document.getElementById('sidebar-visibility');\n  if (!sidebarEl || !visEl) return;\n\n  if (this.classList.contains('show')) {\n    sidebarEl.classList.add('normal');\n    sidebarEl.classList.remove('hidden');\n    visEl.classList.add('hide');\n    visEl.classList.remove('show');\n  } else {\n    sidebarEl.classList.remove('normal');\n    sidebarEl.classList.add('hidden');\n    visEl.classList.add('show');\n    visEl.classList.remove('hide');\n  }\n\n  sidebarEl.classList.add('changed');\n  visEl.style.right = sidebarEl.offsetWidth + 'px';\n  drawGraphics();\n});\n\ndocument.querySelector('#new-track-button:not(.disabled)')?.addEventListener('click', function () {\n  newTrack.push({\n    color: newTrack.defaultColors[Math.floor(Math.random() * newTrack.defaultColors.length)],\n  });\n  newTrack.show();\n});\n\ndocument.getElementById('play-pause-button')?.addEventListener('click', function (this: HTMLElement) {\n  if (this.classList.contains('play')) {\n    master.timeline.play();\n    this.classList.remove('play');\n    this.classList.add('pause');\n  } else {\n    master.timeline.pause();\n    this.classList.remove('pause');\n    this.classList.add('play');\n  }\n});\n\ndocument.querySelector('#undo-button:not(.disabled)')?.addEventListener('click', function () {\n  master.undo();\n});\n\ndocument.querySelector('#screen-fit-button')?.addEventListener('click', function (this: HTMLElement) {\n  if (!this.classList.contains('disabled')) {\n    master.positioning.zoom = 1;\n    master.positioning.autoZoom = true;\n    master.positioning.stuck = true;\n    drawGraphics();\n    this.classList.add('disabled');\n  }\n});\n\ndocument.querySelector('#redo-button:not(.disabled)')?.addEventListener('click', function () {\n  master.redo();\n});\n\ndocument.getElementById('export-button')?.addEventListener('click', function (this: HTMLElement) {\n  if (!this.classList.contains('disabled')) exportData.show();\n});\n\ndocument.querySelector('#save-button:not(.disabled)')?.addEventListener('click', function () {\n  saveProject.show();\n});\n\ndocument.querySelectorAll('.help-button:not(.disabled)').forEach(function (el) {\n  el.addEventListener('click', function () {\n    window.open('using_jstrack.pdf', '_blank');\n  });\n});\n\ndocument.querySelector('#scale-button:not(.disabled)')?.addEventListener('click', function () {\n  if (master.scale !== undefined && master.scale !== null) {\n    editScale\n      .push({\n        color: master.scale.color,\n      })\n      .show();\n  } else {\n    newScale.show();\n  }\n});\n\ndocument.querySelector('#edit-project-button:not(.disabled)')?.addEventListener('click', function () {\n  if (!master.axes) return;\n  editProject\n    .push({\n      name: master.name,\n      framerate: String(master.timeline.fps),\n      frameskip: String(master.timeline.frameSkip),\n      axesColor: master.axes.color,\n      pointsForward: String(master.viewPoints.forward),\n      pointsBackward: String(master.viewPoints.backward),\n    })\n    .show();\n});\n\nmaster.on('undo, created, change', function (this: typeof master) {\n  const el = document.getElementById('undo-button');\n  if (!el) return;\n  if (this.undoManager.hasUndo()) el.classList.remove('disabled');\n  else el.classList.add('disabled');\n});\n\nmaster.on('redo, created, change', function (this: typeof master) {\n  const el = document.getElementById('redo-button');\n  if (!el) return;\n  if (this.undoManager.hasRedo()) el.classList.remove('disabled');\n  else el.classList.add('disabled');\n});\n\nconst trackListUl = document.getElementById('track-list')?.querySelector('ul');\nif (trackListUl) {\n  trackListUl.querySelectorAll('li').forEach(function (element) {\n    element.addEventListener('click', function (this: HTMLElement) {\n      const uid = this.getAttribute('data-uid');\n      if (uid) master.switchTrack(uid);\n    });\n    element.addEventListener('dblclick', function (this: HTMLElement) {\n      const uid = this.getAttribute('data-uid');\n      if (uid && master.trackList[uid] !== undefined) {\n        editTrack\n          .push({\n            name: master.trackList[uid].name,\n            color: master.trackList[uid].color,\n            uid: uid,\n          })\n          .show();\n      }\n    });\n  });\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { master } from './globals';\nimport { hideLoader } from './functions';\n\nexport function loadVideo(file: File | Blob, callback: (() => void) | null = null): void {\n  master.videoFile = file;\n  master.timeline.video.src = URL.createObjectURL(file);\n  if (callback !== null) {\n    master.timeline.video.addEventListener('playing', callback);\n  }\n}\n\nexport function loadProject(file: File, callback: (() => void) | null = null): void {\n  const fileUrl = URL.createObjectURL(file);\n  JSZipUtils.getBinaryContent(fileUrl, function (err: Error | null, data: ArrayBuffer) {\n    if (err) {\n      throw err;\n    }\n\n    JSZip.loadAsync(data).then(function (zipData: JSZip) {\n      if (zipData.files['video.mp4'] !== undefined) {\n        zipData\n          .file('video.mp4')\n          .async('blob')\n          .then(function (videoBlob: Blob) {\n            loadVideo(videoBlob, function () {\n              if (zipData.files['meta.json'] !== undefined) {\n                zipData\n                  .file('meta.json')\n                  .async('text')\n                  .then(function (projectJson: string) {\n                    master.load(JSON.parse(projectJson));\n                    hideLoader();\n                    master.saved = true;\n                    master.trigger('created');\n                    if (callback !== null) callback();\n                  });\n              }\n            });\n          });\n      }\n    });\n  });\n}\n\nexport function hideLaunchModal(): void {\n  const container = document.getElementById('modal-container');\n  if (container) {\n    container.classList.remove('active');\n    container.classList.remove('launch');\n  }\n  const launch = document.getElementById('launch');\n  if (launch) launch.classList.remove('active');\n\n  const helpFab = document.getElementById('help-fab');\n  if (helpFab) helpFab.remove();\n  const githubFab = document.getElementById('github-fab');\n  if (githubFab) githubFab.remove();\n  const paypalFab = document.getElementById('paypal-fab');\n  if (paypalFab) paypalFab.remove();\n\n  keyboardJS.resume();\n}\n\nexport interface BackupData {\n  name: string;\n  data: Record<string, unknown>;\n}\n\nexport let dataLoaded: BackupData | false = false;\n\nexport function setDataLoaded(value: BackupData | false): void {\n  dataLoaded = value;\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { master, newProject, CUSTOM_EXTENSION, VIDEO_CONVERTOR } from './globals';\nimport { showLoader, hideLoader } from './functions';\nimport { loadVideo, loadProject, hideLaunchModal, dataLoaded } from './load';\n\nexport function handleFile(file: File | Blob & { name?: string; type?: string }, callback: (() => void) | null = null): void {\n  const fileType = (file as File).type || '';\n  const fileName = (file as File).name || '';\n\n  switch (fileType) {\n    case 'video/mp4':\n      if (dataLoaded !== false) {\n        let canLoad = false;\n\n        if (fileName !== dataLoaded.name) {\n          if (confirm(\"This file doesn't match what the original video was named. Continue?\"))\n            canLoad = true;\n          else canLoad = false;\n        } else canLoad = true;\n\n        if (canLoad) {\n          loadVideo(file as File, function () {\n            if (callback !== null) callback();\n\n            if (dataLoaded !== false) master.load(dataLoaded.data);\n            hideLoader();\n            hideLaunchModal();\n            master.saved = true;\n            master.trigger('created');\n\n            gtag('event', 'Import Video Existing Project', {\n              event_category: 'Start',\n              event_label: master.name,\n            });\n          });\n        }\n      } else {\n        master.videoName = fileName;\n        loadVideo(file as File, function () {\n          if (callback !== null) callback();\n          master.timeline.detectFrameRate(function (framerate: number) {\n            hideLaunchModal();\n            newProject.push({ framerate: String(framerate) });\n            newProject.show();\n            hideLoader();\n          });\n        });\n      }\n      break;\n    case '':\n    case 'application/x-zip':\n      if (fileName.split('.').pop() === CUSTOM_EXTENSION) {\n        loadProject(file as File, callback);\n        hideLaunchModal();\n        gtag('event', 'Load Project File', {\n          event_category: 'Start',\n          event_label: fileName,\n        });\n      } else {\n        alert('This filetype is not supported. It must be .mp4 or .' + CUSTOM_EXTENSION);\n        hideLoader();\n      }\n      break;\n    default:\n      if (fileType.split('/')[0] === 'video') {\n        if (\n          confirm(\n            \"The only supported video type is mp4. Would you like to try the experimental video converter? (sometimes doesn't work, especially for longer videos)\"\n          )\n        ) {\n          gtag('event', 'Agreed to Try Convertor', {\n            event_category: 'Start',\n            event_label: fileType,\n          });\n          showLoader();\n          const filereader = new FileReader();\n          filereader.onload = function (result: ProgressEvent<FileReader>) {\n            const fileData = result.target?.result as ArrayBuffer;\n\n            const worker = new Worker('src/ffmpeg-worker-mp4.js');\n            worker.onmessage = function (e: MessageEvent<{ type: string; data: { MEMFS: Array<{ data: ArrayBuffer }> } | string }>) {\n              const msg = e.data;\n              switch (msg.type) {\n                case 'ready':\n                  worker.postMessage({\n                    MEMFS: [{ name: fileName, data: fileData }],\n                    type: 'run',\n                    arguments: ['-i', fileName, '-vcodec', 'copy', '-acodec', 'copy', 'out.mp4'],\n                  });\n                  break;\n                case 'done': {\n                  const result = (msg.data as { MEMFS: Array<{ data: ArrayBuffer }> }).MEMFS[0];\n                  const dotIndex = fileName.indexOf('.');\n                  const name = fileName.substring(0, dotIndex !== -1 ? dotIndex : fileName.length);\n                  const blob = new File([result.data], name + '.mp4', {\n                    type: 'video/mp4',\n                  });\n                  master.videoName = blob.name;\n                  loadVideo(blob, function () {\n                    if (callback !== null) callback();\n                    master.timeline.detectFrameRate(function (framerate: number) {\n                      hideLaunchModal();\n                      newProject.push({ framerate: String(framerate) });\n                      newProject.show();\n                      hideLoader();\n                    });\n                  });\n\n                  gtag('event', 'Convertor Done', {\n                    event_category: 'Start',\n                    event_label: fileType,\n                  });\n                  break;\n                }\n              }\n            };\n          };\n          filereader.readAsArrayBuffer(file as File);\n        } else if (\n          confirm('Would you like to open a free online video converter in another tab?')\n        ) {\n          hideLoader();\n          window.open(VIDEO_CONVERTOR, '_blank');\n        } else {\n          hideLoader();\n        }\n      } else {\n        hideLoader();\n        alert('This filetype is not supported. It must be .mp4 or .' + CUSTOM_EXTENSION);\n      }\n      break;\n  }\n}\n\nexport function handleFiles(files: FileList): void {\n  const fileArray = [...files];\n  if (fileArray.length > 0) {\n    const file = fileArray[0];\n    handleFile(file);\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { master } from './globals';\nimport { dataURLtoBlob, showLoader, hideLoader } from './functions';\nimport { setStorage, getStorage, deleteStorage } from './compatibility';\nimport { loadVideo, hideLaunchModal, setDataLoaded } from './load';\n\nfunction updateBackup(state: number | string | false): void {\n  const backupStatus = document.getElementById('backup-status');\n  if (!backupStatus) return;\n  switch (state) {\n    case 1:\n      backupStatus.style.opacity = '1';\n      backupStatus.style.backgroundColor = 'yellow';\n      if (master.backUpDate) {\n        backupStatus.title =\n          'Partially backed up on ' +\n          master.backUpDate.toLocaleDateString() +\n          ' at ' +\n          master.backUpDate.toLocaleTimeString();\n      }\n      break;\n    case 2:\n      backupStatus.style.opacity = '1';\n      backupStatus.style.backgroundColor = '#07ff07';\n      if (master.backUpDate) {\n        backupStatus.title =\n          'Backed up on ' +\n          master.backUpDate.toLocaleDateString() +\n          ' at ' +\n          master.backUpDate.toLocaleTimeString();\n      }\n      break;\n    case 'loading':\n      backupStatus.style.opacity = '0.5';\n      backupStatus.style.backgroundColor = 'grey';\n      backupStatus.title = 'Backing up...';\n      break;\n    default:\n      backupStatus.style.opacity = '1';\n      backupStatus.style.backgroundColor = 'red';\n      backupStatus.title = 'Unable to backup changes';\n      break;\n  }\n}\n\ninterface BackupInfo {\n  uid: string;\n  video: string | null | undefined;\n  date: string | null;\n  data?: string;\n  videoName?: string;\n}\n\nfunction projectBackup(): void {\n  let success: number | false = false;\n  const fileUrl = URL.createObjectURL(master.videoFile!);\n  JSZipUtils.getBinaryContent(fileUrl, function (err: Error | null, videoFile: ArrayBuffer) {\n    if (err) {\n      console.log(err);\n      success = false;\n      updateBackup(success);\n    }\n\n    const projectInfo = JSON.stringify(master.save());\n    const lastBackupRaw = getStorage('backup');\n    let lastBackup: BackupInfo | null = lastBackupRaw ? JSON.parse(lastBackupRaw) : null;\n\n    if (lastBackup === null) {\n      lastBackup = { uid: '', video: null, date: null };\n    }\n\n    const toBackup: BackupInfo = {\n      uid: String(master.uid),\n      date: new Date().toString(),\n      videoName: master.videoName,\n      video: undefined,\n      data: undefined,\n    };\n\n    const sameProject = lastBackup.uid === String(master.uid);\n\n    deleteStorage('backup');\n\n    const dataZip = new JSZip();\n    dataZip.file('meta.json', projectInfo);\n    dataZip.generateAsync({ type: 'blob' }).then(\n      function (blob: Blob) {\n        const reader = new FileReader();\n        reader.readAsDataURL(blob);\n        reader.onload = function () {\n          try {\n            toBackup.data = reader.result as string;\n            setStorage('backup', JSON.stringify(toBackup));\n\n            if (\n              lastBackup!.video === null ||\n              lastBackup!.video === '' ||\n              lastBackup!.video === undefined ||\n              !sameProject\n            ) {\n              const videoZip = new JSZip();\n              videoZip.file('video.mp4', videoFile, { binary: true });\n              videoZip.generateAsync({ type: 'blob' }).then(\n                function (blob: Blob) {\n                  const reader = new FileReader();\n                  reader.readAsDataURL(blob);\n                  reader.onload = function () {\n                    try {\n                      setStorage('video', reader.result as string);\n                      deleteStorage('video');\n                      toBackup.video = reader.result as string;\n                      setStorage('backup', JSON.stringify(toBackup));\n                      master.backup();\n                      success = 2;\n                      updateBackup(success);\n                    } catch {\n                      toBackup.video = undefined;\n                      setStorage('backup', JSON.stringify(toBackup));\n                      master.backup();\n                      success = 1;\n                      updateBackup(success);\n                    }\n                  };\n                },\n                function (err: Error) {\n                  console.log(err);\n                  success = false;\n                  updateBackup(success);\n                }\n              );\n            } else if (sameProject) {\n              if (\n                lastBackup!.video !== null &&\n                lastBackup!.video !== '' &&\n                lastBackup!.video !== undefined\n              ) {\n                try {\n                  setStorage('video', lastBackup!.video);\n                  deleteStorage('video');\n                  toBackup.video = lastBackup!.video;\n                  setStorage('backup', JSON.stringify(toBackup));\n                  master.backup();\n                  success = 2;\n                  updateBackup(success);\n                } catch {\n                  toBackup.video = undefined;\n                  setStorage('backup', JSON.stringify(toBackup));\n                  master.backup();\n                  success = 1;\n                  updateBackup(success);\n                }\n              } else {\n                success = 1;\n                updateBackup(success);\n              }\n            } else {\n              success = 1;\n              updateBackup(success);\n            }\n          } catch {\n            if (lastBackupRaw) setStorage('backup', lastBackupRaw);\n            master.backup();\n            success = false;\n            updateBackup(success);\n          }\n        };\n      },\n      function (err: Error) {\n        console.log(err);\n        success = false;\n        updateBackup(success);\n      }\n    );\n  });\n}\n\nmaster.on('change', function (this: typeof master) {\n  if (!this.saved && this.created && !this.backedUp) {\n    updateBackup('loading');\n    projectBackup();\n  } else if (this.saved) {\n    deleteStorage('backup');\n  }\n});\n\nconst backupRaw = getStorage('backup');\nif (backupRaw !== undefined && backupRaw !== null && backupRaw !== '') {\n  const launchEl = document.getElementById('launch');\n  if (launchEl && launchEl.classList.contains('active')) {\n    const backupInfo: BackupInfo = JSON.parse(backupRaw);\n    const dateStr = backupInfo.date || new Date().toString();\n    const date = new Date(dateStr).toLocaleString();\n    if (\n      confirm(\n        'You have a project backup from ' + date + '. Would you like to recover this?'\n      )\n    ) {\n      if (\n        backupInfo.video !== undefined &&\n        backupInfo.video !== null &&\n        backupInfo.video !== ''\n      ) {\n        showLoader();\n        const file = dataURLtoBlob(backupInfo.video);\n\n        const fileUrl = URL.createObjectURL(file);\n        JSZipUtils.getBinaryContent(\n          fileUrl,\n          function (err: Error | null, data: ArrayBuffer) {\n            if (err) throw err;\n\n            JSZip.loadAsync(data).then(function (zipData: JSZip) {\n              zipData\n                .file('video.mp4')\n                .async('blob')\n                .then(function (videoBlob: Blob) {\n                  loadVideo(videoBlob, function () {\n                    if (\n                      backupInfo.data !== undefined &&\n                      backupInfo.data !== null &&\n                      backupInfo.data !== ''\n                    ) {\n                      const dataFile = dataURLtoBlob(backupInfo.data);\n\n                      const dataFileUrl = URL.createObjectURL(dataFile);\n                      JSZipUtils.getBinaryContent(\n                        dataFileUrl,\n                        function (err: Error | null, innerData: ArrayBuffer) {\n                          if (err) throw err;\n\n                          JSZip.loadAsync(innerData).then(function (\n                            innerZipData: JSZip\n                          ) {\n                            innerZipData\n                              .file('meta.json')\n                              .async('text')\n                              .then(function (projectJson: string) {\n                                master.load(JSON.parse(projectJson));\n                                hideLoader();\n                                hideLaunchModal();\n                                master.saved = true;\n                                master.trigger('created');\n                              });\n                          });\n                        }\n                      );\n                    }\n                  });\n                });\n            });\n          }\n        );\n      } else if (\n        backupInfo.data !== undefined &&\n        backupInfo.data !== null &&\n        backupInfo.data !== ''\n      ) {\n        const file = dataURLtoBlob(backupInfo.data);\n        const fileUrl = URL.createObjectURL(file);\n        JSZipUtils.getBinaryContent(\n          fileUrl,\n          function (err: Error | null, data: ArrayBuffer) {\n            if (err) throw err;\n\n            JSZip.loadAsync(data).then(function (zipData: JSZip) {\n              zipData\n                .file('meta.json')\n                .async('text')\n                .then(function (projectJson: string) {\n                  let videoName = '';\n                  let rawVideoName = '';\n                  if (\n                    backupInfo.videoName !== undefined &&\n                    backupInfo.videoName !== null &&\n                    backupInfo.videoName !== ''\n                  ) {\n                    videoName = '(' + backupInfo.videoName + ') ';\n                    rawVideoName = backupInfo.videoName;\n                  }\n                  if (\n                    confirm(\n                      'There is no video saved in this backup, you will need to be able to access the original video ' +\n                        videoName +\n                        'to load it yourself. Would you like to continue?'\n                    )\n                  ) {\n                    const dropText = document\n                      .getElementById('file-drop-area')\n                      ?.querySelector('.text');\n                    if (dropText)\n                      dropText.textContent =\n                        'Drag the video here to recover your project, or';\n                    setDataLoaded({\n                      name: rawVideoName,\n                      data: JSON.parse(projectJson),\n                    });\n                  } else {\n                    if (\n                      confirm(\n                        'Would you like to remove this backup from storage?'\n                      )\n                    ) {\n                      deleteStorage('backup');\n                    }\n                  }\n                });\n            });\n          }\n        );\n      } else {\n        if (\n          confirm(\n            'Error opening project. Would you like to remove it from storage?'\n          )\n        ) {\n          deleteStorage('backup');\n        }\n      }\n    } else {\n      if (confirm('Would you like to delete this from storage?')) {\n        deleteStorage('backup');\n      }\n    }\n  }\n}\n","/**\n * jsTrack: web-based Tracker (https://physlets.org/tracker/). Get position data from objects in a video.\n * Copyright (C) 2018 Luca Demian\n */\n\nimport { sidebar } from './globals';\nimport { drawGraphics } from './index';\nimport { handleFiles } from './handlefiles';\nimport { showLoader } from './functions';\n\ninteract('#sidebar')\n  .resizable({\n    edges: { left: true },\n    restrictEdges: {\n      outer: 'parent',\n      endOnly: true,\n    },\n    restrictSize: {\n      min: { width: 400 },\n      max: { width: window.innerWidth - 300 },\n    },\n    inertia: true,\n  })\n  .on('resizemove', function (event: InteractEvent) {\n    const target = event.target;\n    target.style.width = event.rect.width + 'px';\n    const vis = document.getElementById('sidebar-visibility');\n    if (vis) vis.style.right = event.rect.width + 'px';\n  })\n  .on('resizeend', function () { drawGraphics(); });\n\nconst sidebarEl = document.getElementById('sidebar');\nconst panelMove = dragula(sidebarEl ? [sidebarEl] : [], {\n  direction: 'vertical',\n  moves: function (el: HTMLElement, _source: HTMLElement, handle: HTMLElement) {\n    if (!handle.classList.contains('handle-bar')) {\n      return false;\n    } else {\n      handle.style.cursor = 'grabbing';\n      return true;\n    }\n  },\n});\n\nlet scroll = 0;\nlet scrollInterval: ReturnType<typeof setInterval> | null = null;\npanelMove\n  .on('drag', function (el: HTMLElement) {\n    const handleBar = el.querySelector('.handle-bar') as HTMLElement | null;\n    if (handleBar) handleBar.style.cursor = 'grabbing';\n    scrollInterval = setInterval(function () {\n      const mirror = document.querySelector('.gu-mirror');\n      if (!mirror) return;\n      const position = mirror.getBoundingClientRect();\n\n      if (panelMove.dragging) {\n        if (position.top < 100) {\n          scroll = -1;\n        } else if (position.top > window.innerHeight - 100) {\n          scroll = 1;\n        } else {\n          scroll = 0;\n        }\n      } else {\n        scroll = 0;\n      }\n      const sidebarScroll = document.getElementById('sidebar');\n      if (sidebarScroll) sidebarScroll.scrollTop += scroll * 20;\n    }, 100);\n  })\n  .on('dragend', function (el: HTMLElement) {\n    const handleBar = el.querySelector('.handle-bar') as HTMLElement | null;\n    if (handleBar) handleBar.style.cursor = 'grab';\n    if (scrollInterval !== null) {\n      clearInterval(scrollInterval);\n      scrollInterval = null;\n    }\n  });\n\nlet resizeTimer: ReturnType<typeof setTimeout>;\nwindow.addEventListener('resize', function () {\n  clearTimeout(resizeTimer);\n  resizeTimer = setTimeout(drawGraphics, 250);\n  const vis = document.getElementById('sidebar-visibility');\n  if (vis) vis.style.right = sidebar.offsetWidth + 'px';\n});\n\n//  File drop area \n\nconst dropArea = document.getElementById('file-drop-area');\nif (dropArea) {\n  ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(function (eventName) {\n    dropArea.addEventListener(\n      eventName,\n      function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      },\n      false\n    );\n    document.body.addEventListener(\n      eventName,\n      function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      },\n      false\n    );\n  });\n\n  ['dragenter', 'dragover'].forEach(function (eventName) {\n    dropArea.addEventListener(\n      eventName,\n      function () {\n        dropArea.classList.add('highlight');\n      },\n      false\n    );\n  });\n\n  ['dragleave', 'drop'].forEach(function (eventName) {\n    dropArea.addEventListener(\n      eventName,\n      function () {\n        dropArea.classList.remove('highlight');\n      },\n      false\n    );\n  });\n\n  dropArea.addEventListener(\n    'drop',\n    function (e: DragEvent) {\n      showLoader();\n      const dt = e.dataTransfer;\n      if (dt) {\n        const files = dt.files;\n        handleFiles(files);\n      }\n    },\n    false\n  );\n}\n\nconst fileInput = document.getElementById('file-input') as HTMLInputElement | null;\nif (fileInput) {\n  fileInput.addEventListener('change', function (this: HTMLInputElement) {\n    if (this.files) {\n      handleFiles(this.files);\n      showLoader();\n    }\n  });\n}\n"],"names":["hideLoader","el","document","getElementById","classList","remove","showLoader","add","dataURLtoBlob","dataurl","arr","split","mimeMatch","match","mime","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","Blob","type","Array","prototype","last","this","Number","roundTo","x","parseFloat","String","toFixed","roundSig","toPrecision","toDegrees","Math","PI","toRadians","sigFigs","log10","log","abs","replace","floor","cot","number","tan","utf8Length","m","encodeURIComponent","Point","constructor","track","frame","y","hidden","pointSize","shape","createjs","Shape","cursor","regX","regY","unscaled","project","toUnscaled","rotation","hitArea","Graphics","beginFill","drawRect","strokeWidth","graphics","setStrokeStyle","command","strokeColor","beginStroke","color","pointRect","circle","drawEllipse","deleted","state","mode","stage","addChild","tempShape","modeChange","removeChild","moving","on","e","coords","toScaled","stageX","stageY","move","select","goTo","change","undo","redo","update","tempPoint","deletedPoints","points","unselectAll","timeline","seek","switchTrack","uid","changed","hide","show","style","axes","scale","point","startFrame","endFrame","location","convert","data","t","videoSpeed","time","getFrameStart","pixels","scaled","emphasize","multiple","unemphasizeAll","emphasizedPoint","unemphasize","width","w","h","selectedPoint","unselect","internal","unRemove","Table","columns","tableData","columnArray","title","push","settings","makeActive","handsOnTable","updateSettings","loadData","newCols","newData","i","tempRow","column","undefined","sort","addColumn","newColumns","tempData","addRow","row","index","a","b","aVal","bVal","Track","name","selectedPoints","unit","toString","table","round","random","listElement","container","createElement","swath","visibility","delete","setAttribute","background","innerText","trackListUl","querySelector","appendChild","_mode","_lastMode","_selected","modeCallbacks","selectionCallbacks","val","triggerChange","call","resetMode","tempLastMode","selected","selectionChange","tempTrack","addEventListener","mouseCoords","globalToLocal","lastUid","editTrackModal","window","stopPropagation","undeleteTrack","deleteTrack","contains","key","pointKey","hasOwnProperty","pointData","export","pushData","addPoint","userAction","toGo","trigger","updateVisiblePoints","newPoint","activeFrames","querySelectorAll","forEach","Axes","theta","styles","size","sqrt","pow","innerWidth","innerHeight","hitShape","parent","rotating","target","_testMouseOver","mouseX","mouseY","coordsUnscaled","sign","reference","atan","lastCoords","lastCoordsUnscaled","newCoordsUnscaled","lastRotation","newRotation","rotate","radians","updateColor","cursorDegree","origin","interceptX","interceptY","signX","Scale","x1","y1","x2","y2","nodeSize","positions","textValue","math","valueProcessed","processValue","nodes","styleCommands","colors","scaled1","scaled2","line","lineStart","moveTo","lineEnd","lineTo","endStroke","textSizingElement","mainContainer","letterWidth","getBoundingClientRect","textElement","readOnly","border","value","text","DOMElement","textHitShape","textHit","offsetWidth","offsetHeight","_scale","blur","format","scaledCoord","updateInfo","units","returnData","trim","to","notation","precision","oldInfo","newInfo","multiply","divide","toNumber","Frame","Modal","schema","create","id","fields","buttons","callbacks","created","defaultColors","event","callback","events","tempEvent","element","titleElement","field","formItem","formInputId","formItemInput","picker","CP","defaultValue","initVal","set","formItemLabel","label","htmlFor","textContainer","paragraph","innerHTML","buttonContainer","button","buttonItem","image","backgroundImage","modalRef","buttonTemp","modalContainer","exportData","fieldId","clear","EXPORT_FORMATS","CUSTOM_EXTENSION","sidebar","videoContainer","canvas","Stage","Bitmap","background2","tableContainer","master","videoName","addBackground","backgroundScale","saved","backedUp","backUpDate","videoFile","trackList","deletedTracks","axesList","undoManager","UndoManager","saveIndex","backUpIndex","getIndex","viewPoints","forward","backward","autoColumnSize","manualColumnResize","manualColumnMove","tableClassName","rowHeaders","colHeaders","startRows","fixedColsLeft","preventOverflow","stretchH","positioning","_zoom","_x","_y","stuck","autoZoom","_callbacks","zoom","oldZoom","zoomChange","video","videoWidth","videoHeight","updateScale","delta","argArray","reset","platform","xNum","yNum","changing","unchanging","frames","j","backup","Date","eventList","actions","currentFrame","frameSkip","destroy","save","metaInfo","date","createdWith","appVersion","fileVersion","saveData","duration","fps","position","activeTrack","tracks","trackInfo","meta","load","fileData","version","fileInfo","updateTiming","createFrames","_load","detectFrameRate","scaleData","newScale","axesData","newAxes","tracksData","newTrack","splice","makeDefault","deleteScale","height","frameTime","frameCount","currentTime","lastFrame","direction","savedTime","seekSaved","counter","tempVideo","firstLoad","onloadeddata","newCanv","newCtx","getContext","drawImage","tempTime","toDataURL","console","matchCount","startFrameTime","framerate","src","currentImage","getImage","lastTime","ctx","img","Image","play","options","playInterval","loop","startingTime","startingFrame","endingFrame","speed","setInterval","next","setFrame","pause","clearInterval","savedFrame","ratios","current","frameNum","getClosestFrame","nextFrameNum","pickedFrame","prev","prevFrameNum","Handsontable","clone","display","posTextBackground","posTextBackgroundCommand","posText","Text","enableMouseOver","Ticker","newProject","required","frameskip","videospeed","axesColor","pointsBackward","pointsForward","submit","saveProject","filename","cancel","saveFile","saveDrive","editProject","editScale","editTrack","setStorage","localStorage","setItem","getStorage","getItem","deleteStorage","removeItem","confirmationMessage","returnValue","scrubberCanv","scrubber","scrubberLineRectShape","scrubberLineRect","drawRoundRect","thumb","rect","marker","SpriteSheet","images","animations","default","startMarkerSprite","Sprite","endMarkerSprite","scrubberLine","rectShape","thumbShape","startMarker","endMarker","frameBack","frameBackClicked","frameBackDisabled","frameForward","frameForwardClicked","frameForwardDisabled","forwardSprite","backSprite","frameArrows","sprite","ButtonHelper","enabled","back","gotoAndStop","updateScrubber","total","drawGraphics","_initialDraw","sidebarVis","right","min","bg","scaleX","render","nextFrame","closestFrame","startMarkerStuck","startFrames","lastVal","endMarkerStuck","endFrames","originalCoords","originalPosition","backgroundDimensions","newPos","preventDefault","deltaY","children","find","c","Object","keys","exportBtn","secondVidTimeout","video2","clearTimeout","setTimeout","opacity","DriveUpload","apiKey","clientId","buttonEl","logoutEl","_getFile","getFile","open","bind","gapi","auth","signOut","disabled","client","setApiKey","_driveApiLoaded","getToken","_upload","_doAuth","file","metadata","request","path","method","params","uploadType","headers","byteLength","JSON","stringify","body","then","response","resumableURI","uploadFileRequest","XMLHttpRequest","token","setRequestHeader","access_token","onreadystatechange","readyState","DONE","send","immediate","authorize","client_id","scope","authuser","parseInt","axesPos","gtag","event_category","event_label","modalData","fileUrl","URL","createObjectURL","JSZipUtils","getBinaryContent","err","toLowerCase","getTime","pop","projectInfo","zip","JSZip","binary","generateAsync","mimeType","blob","saveAs","checkLoaded","saveDriveBtn","exported","zipFile","reader","FileReader","onload","result","success","readAsArrayBuffer","workbook","XLSX","utils","book_new","ws","aoa_to_sheet","book_append_sheet","includes","writeFile","scaleClickCounter","locations","point1","point2","posTextEl","dispatchEvent","Event","focus","keyboardJS","preventRepeat","reload","sidebarEl","visEl","hasUndo","hasRedo","loadVideo","hideLaunchModal","launch","helpFab","githubFab","paypalFab","resume","getAttribute","dataLoaded","handleFiles","files","fileArray","fileType","fileName","canLoad","confirm","loadAsync","zipData","async","videoBlob","projectJson","parse","loadProject","alert","filereader","worker","Worker","onmessage","msg","postMessage","MEMFS","arguments","dotIndex","indexOf","substring","File","handleFile","updateBackup","backupStatus","backgroundColor","toLocaleDateString","toLocaleTimeString","lastBackupRaw","lastBackup","toBackup","sameProject","dataZip","readAsDataURL","videoZip","projectBackup","backupRaw","launchEl","backupInfo","dateStr","toLocaleString","dataFile","dataFileUrl","innerData","innerZipData","rawVideoName","dropText","textContent","interact","resizable","edges","left","restrictEdges","outer","endOnly","restrictSize","max","inertia","vis","panelMove","dragula","moves","_source","handle","resizeTimer","scrollInterval","handleBar","mirror","dragging","top","sidebarScroll","scrollTop","dropArea","eventName","dt","dataTransfer","fileInput"],"sourceRoot":""}