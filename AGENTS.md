# AGENTS.md

Guidance for AI agents (e.g., Cursor) when working with the trackTS codebase.

## Project Overview

trackTS is a web-based video tracking application. Users extract position data from objects in videos for motion analysis.

## Quick Reference

### Commands

```bash
npm install          # Install dependencies
npm run dev          # Development build (watch mode)
npm run build        # Production build
npm run lint         # Check lint
npm run lint:fix     # Auto-fix lint
npm run format       # Format code
```

### Entry Points

- **TypeScript**: `ts/main.ts` — imports modules in a specific order; do not reorder without care.
- **HTML**: `index.html` — loads external libs from `src/` via `<script>` tags.
- **Build output**: `dist/bundle.iife.js` — generated by Vite; do not edit directly.

## Architecture

### Tech Stack

- **TypeScript** (strict mode) + Vite
- **CreateJS (EaselJS)** — canvas rendering
- **Handsontable** — data tables
- **math.js** — unit conversion
- External libs in `src/` — vendored, do not modify

### Data Model

```
Project
├── Timeline (video + frame management)
├── Track[] (each tracked object)
│   ├── Point[] (position per frame)
│   └── Table (data grid)
├── Scale (pixel-to-unit mapping)
└── Axes (coordinate system)
```

### Key Patterns

- **Global state**: Single `master` Project in `ts/globals.ts`.
- **Events**: Classes use `trigger()` / `on()` for callbacks.
- **Canvas**: CreateJS Stage manages overlays (points, tracks, axes, scale) on video frames.

### Directory Structure

| Path | Purpose |
|------|---------|
| `ts/` | TypeScript source |
| `ts/classes/` | Project, Track, Timeline, Point, Frame, Scale, Axes, Table, Modal |
| `ts/globals.ts` | Master Project, Stage, DOM refs |
| `ts/index.ts` | Render loop, canvas drawing |
| `ts/functions.ts` | Utilities |
| `src/` | Vendored libs (do not edit) |
| `dist/` | Build output |

## Agent Guidelines

1. **Import order**: `ts/main.ts` defines module load order; changes can break initialization.
2. **Path alias**: `@/*` maps to `ts/*` in imports.
3. **Linting**: Run `npm run lint:fix` before committing.
4. **No direct edits**: Do not edit `dist/bundle.iife.js` or vendored files in `src/`.
5. **File formats**: `.trackts` = ZIP (JSON + video); exports: XLSX, CSV, TXT.

## Related Docs

- [README.md](README.md) — User-facing setup and usage
- [CLAUDE.md](CLAUDE.md) — Detailed Claude/developer guidance
